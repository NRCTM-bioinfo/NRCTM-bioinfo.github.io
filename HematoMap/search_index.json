[["index.html", "HematoMap Tutorial Chapter 1 Abstract", " HematoMap Tutorial Yu-Ting Dai, Wen Ou-Yang 2024-07-22 Chapter 1 Abstract Acute leukemia is a malignant disorder that arises from the clonal proliferation of leukemic blast cells. The presentation and progression of acute leukemia can vary greatly among different subgroups of patients, and even within the same patient, leukemia cells with different characteristics can coexist. There are two distinct models to understand cellular heterogeneity and cell-of-origin of acute leukemia: the genomic model and the hematopoietic stem cell (HSC) model. Although the genomic model can explain much of the heterogeneity in leukemia, its explanatory power is limited. The HSC model suggests that leukemia is caused by a small population of self-renewing and differentiation-arrested stem cells, while other leukemia cells are their differentiated progeny. Here we introduce HematoMap, an R package that provides a visual representation of the cellular hematopoietic hierarchy of human bone marrow, integrating information from single-cell-based gene expression data to generate a unified model of hematopoietic cell differentiation. By re-analyzing and re-annotating single-cell RNA sequencing data, the project constructed a hierarchy-based reference to interpret normal hematopoiesis cellular compositions and developed a likelihood score to accurately project leukemic blast cells onto the cellular hierarchy of normal hematopoietic differentiation. The article highlights the importance of identifying the cell-of-origin and resolving heterogeneity of acute leukemia to provide critical insights into the pathogenesis of this disease and inform the development of novel therapeutic strategies. "],["introduction.html", "Chapter 2 Introduction 2.1 Introduction of acute leukemia 2.2 What can HematoMap do 2.3 Data resources in HematoMap 2.4 Outline of this tutorial", " Chapter 2 Introduction 2.1 Introduction of acute leukemia Acute leukemia (AL) is a malignant disorder of hematopoiesis that arises from the clonal proliferation of leukemic blast cells. The presentation and progression of leukemia can vary greatly among different subgroups of patients. Additionally, within the same patient, leukemia cells with different characteristics can coexist. There are two distinct models for understanding cellular heterogeneity and cell-of-origin of acute leukemia: one is the genomic model, and the other is the stem-cell model. The genomic model of acute leukemia is based on the identification of genomic lesions, such as recurrent somatic mutations or fusions. These mutations/fusions are involved in several categories, including transcriptional regulation, signaling pathways, and epigenetic modifiers. However, although the genomic model can explain much of the heterogeneity in leukemia, even cells with the same mutation may have different functions, so the explanatory power of the genomic model is limited. Another classic model is the hematopoietic stem cell (HSC) model, which suggests that leukemia is caused by a small population of self-renewing and differentiation-arrested stem cells (also known as leukemia stem cells, LSC). These leukemia stem cells possess characteristics similar to normal hematopoietic stem cells, such as the ability to self-renew and produce different types of other blood cells, while other leukemia cells are their differentiated progeny. According to this model, leukemia is a hierarchical disease in which leukemia stem cells are located at the top of the hierarchy, while more differentiated leukemia cells are at the bottom. The hematopoietic stem cell model provides a better explanation for leukemia heterogeneity, as it can explain why different types of leukemia cells can exist even within the same patient. The differentiation trajectory of hematopoiesis in a healthy human body is extremely complex and crucial for understanding the mechanism of leukemia. In the past, methods such as bone marrow tissue sectioning and cell culture were commonly used to understand the differentiation process of hematopoietic cells. However, these methods still have limitations, such as the inability to comprehensively and accurately reflect the phenotypic and functional characteristics of hematopoietic cells at different developmental stages. In recent years, with the development of sequencing technologies, especially single-cell sequencing, new insights has been brought into the hematopoietic cell differentiation exploration. 2.2 What can HematoMap do Here we present HematoMap, a comprehensive R package that can provide a visual representation of the cellular hematopoietic hierarchy of human bone marrow. It is a mapping tool that integrates information from single-cell based gene expression data and generate a unified model of hematopoietic cell differentiation. HematoMap allows researchers to explore the relationships between different hematopoietic cell types (such as HSC/MPP, CML and CLP) and interpret normal hematopoiesis cellular compositions. In this HematoMap project, by re-collecting, re-analyzing, and re-annotating single-cell RNA sequencing (scRNA-seq) data of normal bone marrow mononuclear cells (BMMCs), we constructed a hierarchy-based reference to interpret normal hematopoiesis cellular compositions. A likelihood score was also developed to comprehensively and accurately project leukemic blast cells onto the cellular hierarchy of normal hematopoietic differentiation. The identification of the cell-of-origin and resolution of heterogeneity of acute leukemia is an important long-term goal, as it may provide critical insights into the pathogenesis of this disease and inform the development of novel therapeutic strategies. Using HematoMap, you can do: 1 Visual representation of the cellular composition of normal human BMMCs. 2 Visual representation of cell blockage of acute leukemia. 3 Lineage aberrancy inference using scRNA-seq of acute leukemia. 4 Lineage aberrancy inference using bulk RNA-seq of acute leukemia. 2.3 Data resources in HematoMap The human hematopoietic hierarchy in bone marrow consists of a hierarchical system of cells that differentiate from hematopoietic stem cells (HSCs) to mature blood cells. The hierarchy includes many kinds of progenitors such as multipotent progenitor cells (MPPs), common lymphoid progenitor cells (CLPs), common myeloid progenitor cells (CMPs), megakaryocyte-erythroid progenitor cells (MEPs), and granulocyte-macrophage progenitor cells (GMPs). These progenitor cells differentiate further into more specialized cells, such as erythrocytes, megakaryocytes, granulocytes, monocytes, and lymphocytes. In HematoMap, we provided detailed annotation of hematopoietic cell differentiation based on single-cell data at different hierarchy levels. The annotation of healthy BMMCs could be described as four levels: Level 1: Lineages. HSPCs, Myeloids, Bcells, T/NKcells. Level 2: Populations. HSPCs, Monocytes, Dendritic cells, Erythrocytes, pro B cells, mature B cells, CD8+ T cells, CD4+ T cells, NK cells Level 3: Types. The 42 cell types (including 4 cell cycle related cell types): HSC/MPP, LMPP, CLP, CMP, MDP, GMP, CDP, MEP, GMP-Mono, CD14 Mono, CD16 Mono, pre-DC, pDC, cDC1, mo-DC, MKP, MK, pro-Ery1, pro-Ery2, Ery, pre-pro-B, Early pro-B, 23 Early cycling pro-B, Late pro-B, Late cycling pro-B, pre-B, Immature B, Naive B, Memory B 1, Memory B 2, CD8 Tnaive, CD8 Teff, CD8 Tex, CD8 Tdpe, CD8 Tmpe, CD4 Tnaive, CD4 Tem, CD4 Treg, NK, NK-XCL1, cycling NK, cycling NK/T. Level 4: Sub-clusters. The 1079 cell sub-clusters, for example, HSC/MPP:0001, HSC/MPP:0002, HSC/MPP:0003. The relationship of the four levels and the related marker for cell type identification were listed as followed. Table 2.1: Structure of hierarchy-based cell types in normal BMMCs Lineage Population CellType FullName Markers Reference..PMID. HSPCs HSPCs HSC/MPP Hematopoietic stem cell/Multipotent progenitor CD34(+), KIT(+), FLT3(-), AVP(+), CD38(-), 28650480; HSPCs HSPCs LMPP Lymphoid-primed multipotent progenitor CD34(+), KIT(+), FLT3(+), AVP(+), CD38(-), 28650480; HSPCs HSPCs CLP Common lymphoid progenitor CD34(+), KIT(+), FLT3(+), MME(+/-), CD7(+/-), 28650480; 19996414; HSPCs HSPCs CMP Common myeloid progenitor CD34(+), KIT(+), FLT3(+), CD38(+), CSF1R(-), FCGR1A(-), 28650480; HSPCs HSPCs MDP Monocyte-DC progenitor CD34(+), KIT(+), FLT3(+), CD38(+), CSF1R(+), FCGR1A(+/-), 29166589; 28650480; 28514689; 29313948; HSPCs HSPCs GMP Granulocyte-macrophage progenitor CD34(+), KIT(+), FLT3(+), CD38(+), MPO(+), ELANE(+), FCGR1A(+), 28650480; 26332381; HSPCs HSPCs CDP Common DC progenitor CD34(+), KIT(+), FLT3(+), CD38(+), CSF1R(+), FCGR1A(-), IL3RA(+), 28650480; 29313948; HSPCs HSPCs MEP Megakaryocyte-erythrocyte progenitor CD34(+), KIT(+), FLT3(-), CD38(+), 28650480; Myeloids Monocytes GMP-Mono GMP-Monocytes CD34(-), KIT(-), CD300E(-), LYZ(+), CD36(+), MPO(+), FCGR1A(+), CD4(+) 26282340; 28514689; Myeloids Monocytes CD14 Mono Classical(CD14+CD16−) monocyte CD14(+), FCGR3A(-), CD300E(+), LYZ(+), ITGAX(+), FCGR1A(+), CD4(+) 26332381; 28514689; Myeloids Monocytes CD16 Mono Non-classical(CD14−CD16+) monocyte CD14(-), FCGR3A(+), CD300E(+), LYZ(+), ITGAX(+), CD4(+) 26332381; 28514689; Myeloids Dendritic cells pre-DC Dendritic cell precursor CD34(-), FLT3(+), AXL(+), SIGLEC6(+), ITGAX(+), 29313948; Myeloids Dendritic cells pDC Plasmacytoid dendritic cell CLEC4C(+), IRF4(+), LILRA4(+), IL3RA(+), IRF8(+), IRF7(+), 29313948; 20193018; Myeloids Dendritic cells cDC1 Conventional dendritic cell 1 XCR1(+), CD1C(+), ITGAX(+), IRF8(+), THBD(+), 29313948; Myeloids Dendritic cells mo-DC Monocyte-derived dendritic cell MRC1(+), LYZ(+), ITGAX(+), 29313948; Myeloids Erythrocytes MKP Megakaryocyte progenitor CD34(+), KIT(+), IFLT3(-), ITGA2B(+), Myeloids Erythrocytes MK Megakaryocyte PF4(+), ITGA2B(+), CD9(+), Myeloids Erythrocytes pro-Ery1 Proerythroblast 1 ENG(+), KLF(+), KIT(+), TFRC(+) Myeloids Erythrocytes pro-Ery2 Proerythroblast 2 ENG(+), KLF(+), KIT(-), TFRC(+) Myeloids Erythrocytes Ery Erythroblast ENG(-), KLF(+), TFRC(+) B cells B cells pre-pro-B B cell progenitor precursor CD79A(+), IGLL1(+), RAG1(+), RAG2(+), VPREB1(+), MME(+), IL7R(+), 35090788; 19996414; B cells B cells Early pro-B Early B cell progenitor CD79A(+), DNTT(+), IGLL1(+), RAG1(+), RAG2(+), VPREB1(+), 35090788; B cells B cells Early cycling pro-B Early cycling B cell progenitor MKI67(+), PCNA(+), CD79A(+), DNTT(+), IGLL1(+), RAG1(+), RAG2(+), VPREB1(+), IL7R(-), 35090788; B cells B cells Late pro-B Late B cell progenitor CD79A(+), DNTT(-), IGLL1(+), TCL1A(+), RAG1(+), RAG2(+), VPREB1(+), 35090788; B cells B cells Late cycling pro-B Late cycling B cell progenitor MKI67(+), PCNA(+), CD79A(+), DNTT(-), IGLL1(+), TCL1A(+), RAG1(+), RAG2(+), VPREB1(+), 35090788; B cells B cells pre-B B cell precursor IGLL1(+/-), TCL1A(+), RAG1(+), RAG2(+), VPREB1(+), 35090788; B cells B cells Immature B Immature B cell MS4A1(+), TCL1A(+), RAG1(-), RAG2(-), VPREB1(+/-), 35090788; B cells B cells Naive B Naive B cell MS4A1(+), CD27(-), IGHD(+), TCL1A(+), 35090788; B cells B cells Memory B 1 Memory B cell 1 MS4A1(+), CD27(+), IGHD(+), IGHG3(+/-), 35090788; B cells B cells Memory B 2 Memory B cell 2 MS4A1(-), CD27(+), IGHD(-), IGHG3(++), T/NK cells CD8+ T cells CD8 Tnaive Naive CD8+ T cell CD3D(+), CD3E(+), CD8A(+), CCR7(+), IL7R(+), SELL(+) 29630679; T/NK cells CD8+ T cells CD8 Tdpe KLRG1+IL7R+ double-positive effector CD8+ T CD3D(+), CD3E(+), CD8A(+), IL7R(+), CCR7(-), KLRG1(+), CD27(+) 29625895; T/NK cells CD8+ T cells CD8 Tmpe Memory precursor effector CD8+ T CD3D(+), CD3E(+), CD8A(+), IL7R(+), CCR7(-), KLRG1(dim/-) 29625895; T/NK cells CD8+ T cells CD8 Teff Effector CD8+ T cell CD3D(+), CD3E(+), CD8A(+), CCR7(-), GNLY(+), NKG7(+) 34017005; T/NK cells CD8+ T cells CD8 Tex Exhausted CD8+ T CD3D(+), CD3E(+), CD8A(+), CCR7(-), PDCD1(+), TNFRSF9(+), LAG3(+), CD160(+), 34017005; T/NK cells CD4+ T cells CD4 Tnaive Naive CD4+ T cell CD3D(+), CD3E(+), CD4(+), CCR7(+), IL7R(+), SELL(+), CD40LG(+), 29630679; T/NK cells CD4+ T cells CD4 Tem Memory CD4+ T cell CD3D(+), CD3E(+), CD4(+), CCR7(-), IL7R(+), CD40LG(+), 29630679; T/NK cells CD4+ T cells CD4 Treg Regulatory T cell CD3D(+), CD3E(+), CD4(+), IL2RA(+), FOXP3(+), DUSP4(+) 34017005; T/NK cells NK NK Natural killer cell IL2RB(+), IL7R(-), KLRF1(+), XCL1(-), FCGR3A(+), NCAM1(+), 30150991; T/NK cells NK NK-XCL1 XCL1+ Natural killer cell IL2RB(+), IL7R(-), KLRF1(+), XCL1(+), NCAM1(+), 30150991; T/NK cells NK cycling NK Cycling natural killer cell MKI67(+), PCNA(+), IL2RB(+), IL7R(-), KLRF1(+), FCGR3A(+), NCAM1(+), 30150991; T/NK cells NK cycling NK/T Cycling natural killer/T cell MKI67(+), PCNA(+), CD3D(+), CD3E(+), KLRF(+), IL2RB(+/-), NCAM1(+) 30150991; 2.4 Outline of this tutorial The HematoMap is an R-based package for lineage aberrancy inference based on single-cell RNA sequencing (scRNA-seq) and bulk RNA sequencing (bulk RNA-seq) data of acute leukemia. In this tutorial, we will present: How to install HematoMap. Overview of workflow of HematoMap. scRNA-seq analysis using HematoMap. Bulk RNA-seq analysis using HematoMap. "],["quick-start.html", "Chapter 3 Quick-start 3.1 Installation 3.2 Load package 3.3 Show normal BMMCs 3.4 Quick-start code", " Chapter 3 Quick-start 3.1 Installation 3.1.1 Installation from GitHub This requires the devtools package to be pre-installed first. The HematoMap also required for pre-installation of the Seurat package (https://satijalab.org/seurat/). # If Seurat is not already installed, you need to install Seurat first install.packages(&quot;Seurat&quot;) # If devtools is not already installed, you need to install devtools first install.packages(&quot;devtools&quot;) To install HematoMap # Installation of HematoMap devtools::install_github(&quot;NRCTM-bioinfo/HematoMap&quot;) # library HematoMap library(HematoMap) The source code of HematoMap on GitHub can be accessed at https://github.com/NRCTM-bioinfo/HematoMap. In this chapter, we will describe the main functionalities and a quick-start code template for the workflow of HematoMap. The necessary data for this chapter is already included in the HematoMap package. By reading this chapter, you will learn: Gain an overview of the workflow and the built-in database of HematoMap. A quick-start code about how to use HematoMap. And for the detailed version and advanced application of HematoMap, please read Chapter 4 and Chapter 5. 3.2 Load package # library the Seurat and HematoMap packages library(Seurat) library(pbmcapply) library(HematoMap) 3.3 Show normal BMMCs # Show circle plot of normal BMMC plotCircleTree(group.subc = &quot;reference&quot;, color.mapping = &quot;cell.type&quot;, title = &quot;Normal BMMCs&quot;) # Show cluster-tree plot of normal BMMC plotClusterTree(group.subc = &quot;reference&quot;, color.mapping = &quot;cell.type&quot;, title = &quot;Normal BMMCs&quot;, point.size = 20, label.cell = TRUE) 3.4 Quick-start code # For scRNA-seq analysis # the `scrna` is a seurat object hmap &lt;- HematoMap::CreateSubclusterObject(scrna) # For bulk RNA-seq analysis # the `bulk` is a expression matrix of bulk RNA-seq hmap.bulk &lt;- computeLassoScore(bulk) "],["scrna.html", "Chapter 4 scRNA-seq 4.1 Load scRNA-seq data 4.2 Calculate similarities 4.3 Visualization", " Chapter 4 scRNA-seq 4.1 Load scRNA-seq data In the tutorial, the scRNA-seq of one APL (AML with PML::RARA fusion, also called acute promyelocytic leukemia)) patient (including 3,000 cells) was used for illustration. The expample data of APL scRNA-seq can be downloaded via APL scrna demo data # Library packages library(Seurat) library(HematoMap) # Read count matrix of APL aml.count &lt;- readRDS(&quot;data/AML_scRNA_count.rds&quot;) dim(aml.count) ## [1] 36601 3000 # Construct Seurat object aml &lt;- Seurat::CreateSeuratObject(counts = aml.count, project = &quot;aml&quot;, min.cells = 0, min.features = 0) ## Warning: Data is of class matrix. Coercing to dgCMatrix. aml ## An object of class Seurat ## 36601 features across 3000 samples within 1 assay ## Active assay: RNA (36601 features, 0 variable features) ## 1 layer present: counts # Save the RDS file saveRDS(aml, file = &quot;data/AML_scRNA_seurat.rds&quot;) 4.2 Calculate similarities aml &lt;- readRDS(&quot;data/AML_scRNA_seurat.rds&quot;) # Construct HematoMap object hmap &lt;- HematoMap::CreateSubclusterObject(aml) ## [INFO] 2024-07-22 10:38:20.557213: Subcluster Computing ## | | 0%, ETA NA |========= | 7%, ETA 00:58 |================== | 14%, ETA 00:48 |=========================== | 21%, ETA 00:41 |==================================== | 29%, ETA 00:36 |============================================= | 36%, ETA 00:31 |====================================================== | 43%, ETA 00:26 |================================================================ | 50%, ETA 00:22 |========================================================================= | 57%, ETA 00:19 |================================================================================== | 64%, ETA 00:15 |============================================================================================================= | 86%, ETA 00:04 ## Warning in irlba(A = t(x = object), nv = npcs, ...): You&#39;re computing too large a percentage of total singular values, use a standard svd instead. ## [INFO] 2024-07-22 10:38:46.999342: Subcluster Complete! ## | | 0%, ETA NA |== | 2%, ETA 00:12 |===== | 4%, ETA 00:08 |======= | 6%, ETA 00:07 |========= | 7%, ETA 00:07 |============ | 9%, ETA 00:06 |============== | 11%, ETA 00:06 |================ | 13%, ETA 00:06 |=================== | 15%, ETA 00:05 |===================== | 17%, ETA 00:05 |======================== | 19%, ETA 00:05 |========================== | 20%, ETA 00:05 |============================ | 22%, ETA 00:05 |=============================== | 24%, ETA 00:05 |================================= | 26%, ETA 00:04 |=================================== | 28%, ETA 00:04 |====================================== | 30%, ETA 00:04 |======================================== | 31%, ETA 00:04 |========================================== | 33%, ETA 00:04 |============================================= | 35%, ETA 00:04 |=============================================== | 37%, ETA 00:04 |================================================= | 39%, ETA 00:04 |==================================================== | 41%, ETA 00:04 |====================================================== | 43%, ETA 00:04 |======================================================== | 44%, ETA 00:04 |=========================================================== | 46%, ETA 00:04 |============================================================= | 48%, ETA 00:03 |================================================================ | 50%, ETA 00:03 |================================================================== | 52%, ETA 00:03 |==================================================================== | 54%, ETA 00:03 |======================================================================= | 56%, ETA 00:03 |========================================================================= | 57%, ETA 00:03 |=========================================================================== | 59%, ETA 00:03 |============================================================================== | 61%, ETA 00:02 |================================================================================ | 63%, ETA 00:02 |================================================================================== | 65%, ETA 00:02 |===================================================================================== | 67%, ETA 00:02 |======================================================================================= | 69%, ETA 00:02 |========================================================================================= | 70%, ETA 00:02 |============================================================================================ | 72%, ETA 00:02 |============================================================================================== | 74%, ETA 00:02 |================================================================================================ | 76%, ETA 00:02 |=================================================================================================== | 78%, ETA 00:01 |===================================================================================================== | 80%, ETA 00:01 |======================================================================================================= | 81%, ETA 00:01 |========================================================================================================== | 83%, ETA 00:01 |============================================================================================================ | 85%, ETA 00:01 |=============================================================================================================== | 87%, ETA 00:01 |================================================================================================================= | 89%, ETA 00:01 |=================================================================================================================== | 91%, ETA 00:01 |====================================================================================================================== | 93%, ETA 00:00 |======================================================================================================================== | 94%, ETA 00:00 |========================================================================================================================== | 96%, ETA 00:00 |============================================================================================================================= | 98%, ETA 00:00 |===========================================================================================================================| 100%, Elapsed 00:06 ## [INFO] 2024-07-22 10:38:54.000281: CosineDist Running ## [INFO] 2024-07-22 10:39:18.238693: CosineDist Complete! hmap ## An object of class HematoSubCluster ## 54 sub-clusters with cosine distance # C0:0001 was one of the sub-clusters in hmap # This plot illustrate the &quot;Like&quot; score between sub-cluster in APL and normal BMMCs plotThetaLike(hemato.subc = hmap, plot.scell = &quot;C0:0001&quot;) plotCircleTree(hemato.subc = hmap, plot.scell = &quot;C0:0001&quot;) plotMeanLike(hemato.subc = hmap) 4.3 Visualization # Visualization for APL (circle tree) plotCircleTree(hemato.subc = hmap, group.subc = &quot;external&quot;, top.subc = 3, color.mapping = &quot;cell.type&quot;, title = &quot;APL BMMCs&quot;) # Visualization for APL (circle tree without population label) # clean version plotCircleTree(hemato.subc = hmap, group.subc = &quot;external&quot;, top.subc = 3, color.mapping = &quot;cell.type&quot;, title = &quot;APL BMMCs&quot;, label.population = FALSE) # Visualization for the normal BMMC (the reference) (circle tree) plotCircleTree(hemato.subc = hmap, group.subc = &quot;reference&quot;, top.subc = 3, color.mapping = &quot;cell.type&quot;, title = &quot;Normal BMMCs&quot;) # Visualization for APL (circle tree) plotCircleTree(hemato.subc = hmap, group.subc = &quot;external&quot;, top.subc = 3, color.mapping = &quot;cell.percentage&quot;, title = &quot;APL BMMCs&quot;) # Visualization for the normal BMMC (the reference) (circle tree) plotCircleTree(hemato.subc = hmap, group.subc = &quot;reference&quot;, top.subc = 3, color.mapping = &quot;cell.percentage&quot;, title = &quot;Normal BMMCs&quot;) Visualization using the absolute proportional mode. # Absolute proportional mode # Visualization for APL (hierarchy tree) plotClusterTree(hemato.subc = hmap, group.subc = &quot;external&quot;, color.mapping = &quot;cell.type&quot;, title = &quot;APL BMMCs&quot;, size.mode = &quot;absolute.pct&quot;, top.subc = 3, point.size = 12, label.cell = TRUE) # Absolute proportional mode # Visualization for the normal BMMCs (hierarchy tree) plotClusterTree(hemato.subc = hmap, group.subc = &quot;reference&quot;, color.mapping = &quot;cell.type&quot;, title = &quot;Normal BMMCs&quot;, size.mode = &quot;absolute.pct&quot;, top.subc = 3, point.size = 12, label.cell = TRUE) # Absolute proportional mode # Visualization for APL (hierarchy tree) plotClusterTree(hemato.subc = hmap, group.subc = &quot;external&quot;, color.mapping = &quot;cell.percentage&quot;, title = &quot;APL BMMCs&quot;, size.mode = &quot;absolute.pct&quot;, top.subc = 3, point.size = 12, label.cell = TRUE) # Absolute proportional mode # Visualization for the normal BMMCs (hierarchy tree) plotClusterTree(hemato.subc = hmap, group.subc = &quot;reference&quot;, color.mapping = &quot;cell.percentage&quot;, title = &quot;Normal BMMCs&quot;, size.mode = &quot;absolute.pct&quot;, top.subc = 3, point.size = 12, label.cell = TRUE) Visualization using the relative proportional mode. # Relative proportional mode # Visualization for APL (hierarchy tree) plotClusterTree(hemato.subc = hmap, group.subc = &quot;external&quot;, color.mapping = &quot;cell.type&quot;, title = &quot;APL BMMCs&quot;, size.mode = &quot;relative.pct&quot;, top.subc = 3, point.size = 12, label.cell = TRUE) # Relative proportional mode # Visualization for the normal BMMCs (hierarchy tree) plotClusterTree(hemato.subc = hmap, group.subc = &quot;reference&quot;, color.mapping = &quot;cell.type&quot;, title = &quot;Normal BMMCs&quot;, size.mode = &quot;relative.pct&quot;, top.subc = 3, point.size = 12, label.cell = TRUE) # Relative proportional mode # Visualization for APL (hierarchy tree) plotClusterTree(hemato.subc = hmap, group.subc = &quot;external&quot;, color.mapping = &quot;cell.percentage&quot;, title = &quot;APL BMMCs&quot;, size.mode = &quot;relative.pct&quot;, top.subc = 3, point.size = 12, label.cell = TRUE) # Relative proportional mode # Visualization for the normal BMMCs (hierarchy tree) plotClusterTree(hemato.subc = hmap, group.subc = &quot;reference&quot;, color.mapping = &quot;cell.percentage&quot;, title = &quot;Normal BMMCs&quot;, size.mode = &quot;relative.pct&quot;, top.subc = 3, point.size = 12, label.cell = TRUE) "],["bulk.html", "Chapter 5 Bulk RNA-seq 5.1 Load bulk RNA-seq data 5.2 Visualization", " Chapter 5 Bulk RNA-seq 5.1 Load bulk RNA-seq data The expample data of B-ALL bulk RNA-seq can be downloaded via B-ALL bulk demo data The expample data of AML bulk RNA-seq can be downloaded via AML bulk demo data # Library package library(HematoMap) # Read TPM matrix of B-ALL ball.tpm &lt;- readRDS(&quot;data/BALL_bulk_TPM.rds&quot;) dim(ball.tpm) ## [1] 59982 10 head(ball.tpm) hmap.bulk.ball &lt;- computeLassoScore(ball.tpm) # Read TPM matrix of AML aml.tpm &lt;- readRDS(&quot;data/AML_bulk_TPM.rds&quot;) dim(aml.tpm) ## [1] 59344 10 head(aml.tpm) hmap.bulk.aml &lt;- computeLassoScore(aml.tpm) 5.2 Visualization plotLassoLollipop(hmap.bulk.ball) plotLassoLollipop(hmap.bulk.aml) plotLassoTree(hmap.bulk.ball, color.mapping = &quot;value&quot;, title = &quot;B-ALL bulk&quot;, point.size = 2, label.cell = TRUE) plotLassoTree(hmap.bulk.ball, color.mapping = &quot;cell.type&quot;, title = &quot;B-ALL bulk&quot;, point.size = 2, label.cell = TRUE) plotLassoTree(hmap.bulk.aml, color.mapping = &quot;value&quot;, title = &quot;AML bulk&quot;, point.size = 2, label.cell = TRUE) plotLassoTree(hmap.bulk.aml, color.mapping = &quot;cell.type&quot;, title = &quot;AML bulk&quot;, point.size = 2, label.cell = TRUE) "],["shiny.html", "Chapter 6 Run shiny app 6.1 Open shiny 6.2 scRNA-seq 6.3 Bulk RNA-seq", " Chapter 6 Run shiny app 6.1 Open shiny # Run shiny app HematoMap::runApp() 6.2 scRNA-seq The scRNA-seq of one APL (AML with PML::RARA fusion, also called acute promyelocytic leukemia)) patient (including 3,000 cells) was used for illustration. The input format for RNA-seq analysis was a Seurat object. The expample data of APL scRNA-seq (Seurat object) can be downloaded APL scrna seurat demo data or generated use Seurat::CreateSeuratObject. Click Upload to upload the seurat object. And wait for about one minute for calculation. Visualization of cosine-like score of the subcluster. Circle visualization of APL, colored by cell type. Circle visualization of APL, colored by cell proportion. Cluster-tree visualization of APL, absolute proportional mode. Cluster-tree visualization of APL, relative proportional mode. Cluster-tree visualization of the reference, relative proportional mode. 6.3 Bulk RNA-seq The expample data of B-ALL bulk RNA-seq can be downloaded via B-ALL bulk demo data The expample data of AML bulk RNA-seq can be downloaded via AML bulk demo data Click Upload to upload the expression matrix. Cluster-tree visualization of B-ALL (colored by score value). Cluster-tree visualization of B-ALL (colored by cell type). Lollipop visualization of AML (colored by cell type). "],["about-hematomap.html", "Chapter 7 About HematoMap Bug Reports Current version Acknowledgment Session Information", " Chapter 7 About HematoMap Bug Reports If there is any error in installing or librarying the HematoMap package, please contact us via e-mail dyt12423@rjh.com.cn (Yu-Ting Dai) or wen4862513@sjtu.edu.cn (Wen Ou-Yang). Current version Version: 1.1.0 Release Date: 2024-07-22 Acknowledgment This work was supported by the Interdisciplinary Program of Shanghai Jiao Tong University (project number YG2022QN008), the National Natural Science Foundation of China (82200153, 32170663), Innovative Research Team of High-Level Local Universities in Shanghai. Session Information # Show session information sessionInfo() ## R version 4.3.2 (2023-10-31) ## Platform: x86_64-apple-darwin20 (64-bit) ## Running under: macOS Ventura 13.0.1 ## ## Matrix products: default ## BLAS: /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib ## LAPACK: /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRlapack.dylib; LAPACK version 3.11.0 ## ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ## ## time zone: Asia/Shanghai ## tzcode source: internal ## ## attached base packages: ## [1] parallel stats graphics grDevices utils datasets methods base ## ## other attached packages: ## [1] pbmcapply_1.5.1 shiny_1.8.0 Seurat_5.0.1 HematoMap_1.1.0 SeuratObject_5.0.1 sp_2.1-2 ## ## loaded via a namespace (and not attached): ## [1] RColorBrewer_1.1-3 rstudioapi_0.15.0 jsonlite_1.8.8 magrittr_2.0.3 spatstat.utils_3.0-4 farver_2.1.1 ## [7] rmarkdown_2.25 ragg_1.2.7 vctrs_0.6.5 ROCR_1.0-11 memoise_2.0.1 spatstat.explore_3.2-5 ## [13] htmltools_0.5.7 sass_0.4.8 sctransform_0.4.1 parallelly_1.36.0 bslib_0.6.1 KernSmooth_2.23-22 ## [19] htmlwidgets_1.6.4 ica_1.0-3 plyr_1.8.9 cachem_1.0.8 plotly_4.10.3 zoo_1.8-12 ## [25] commonmark_1.9.0 igraph_1.6.0 mime_0.12 lifecycle_1.0.4 pkgconfig_2.0.3 Matrix_1.6-4 ## [31] R6_2.5.1 fastmap_1.1.1 fitdistrplus_1.1-11 future_1.33.1 digest_0.6.34 colorspace_2.1-0 ## [37] ggnewscale_0.4.9 patchwork_1.1.3 tensor_1.5 RSpectra_0.16-1 irlba_2.3.5.1 textshaping_0.3.7 ## [43] labeling_0.4.3 progressr_0.14.0 fansi_1.0.6 spatstat.sparse_3.0-3 httr_1.4.7 polyclip_1.10-6 ## [49] abind_1.4-5 compiler_4.3.2 withr_3.0.0 fastDummies_1.7.3 highr_0.10 MASS_7.3-60 ## [55] tools_4.3.2 lmtest_0.9-40 httpuv_1.6.13 future.apply_1.11.1 goftest_1.2-3 glue_1.7.0 ## [61] nlme_3.1-164 promises_1.2.1 gridtext_0.1.5 grid_4.3.2 Rtsne_0.17 cluster_2.1.6 ## [67] reshape2_1.4.4 generics_0.1.3 gtable_0.3.4 spatstat.data_3.0-3 tidyr_1.3.0 data.table_1.15.0 ## [73] xml2_1.3.6 utf8_1.2.4 spatstat.geom_3.2-7 RcppAnnoy_0.0.21 ggrepel_0.9.4 RANN_2.6.1 ## [79] pillar_1.9.0 markdown_1.12 stringr_1.5.1 spam_2.10-0 RcppHNSW_0.5.0 later_1.3.2 ## [85] splines_4.3.2 dplyr_1.1.4 ggtext_0.1.2 lattice_0.22-5 survival_3.5-7 deldir_2.0-2 ## [91] tidyselect_1.2.0 miniUI_0.1.1.1 pbapply_1.7-2 knitr_1.45 gridExtra_2.3 bookdown_0.37 ## [97] scattermore_1.2 xfun_0.41 matrixStats_1.2.0 stringi_1.8.3 lazyeval_0.2.2 yaml_2.3.8 ## [103] evaluate_0.23 codetools_0.2-19 tibble_3.2.1 cli_3.6.2 uwot_0.1.16 systemfonts_1.0.5 ## [109] xtable_1.8-4 reticulate_1.34.0 jquerylib_0.1.4 munsell_0.5.0 Rcpp_1.0.11 globals_0.16.2 ## [115] spatstat.random_3.2-2 png_0.1-8 ellipsis_0.3.2 ggplot2_3.4.4 dotCall64_1.1-1 listenv_0.9.0 ## [121] viridisLite_0.4.2 scales_1.3.0 ggridges_0.5.5 leiden_0.4.3.1 purrr_1.0.2 rlang_1.1.3 ## [127] cowplot_1.1.2 "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
