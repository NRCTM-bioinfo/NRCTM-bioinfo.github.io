<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 TCGA PanCanAtlas | p53 compounds</title>
  <meta name="description" content="This is the tutorial of p53 compounds project." />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 TCGA PanCanAtlas | p53 compounds" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is the tutorial of p53 compounds project." />
  <meta name="github-repo" content="NRCTM-bioinfo/p53-compounds" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 TCGA PanCanAtlas | p53 compounds" />
  
  <meta name="twitter:description" content="This is the tutorial of p53 compounds project." />
  

<meta name="author" content="Yu-Ting Dai" />


<meta name="date" content="2024-01-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="cmap-database.html"/>
<link rel="next" href="about-this-project.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="http://www.rescuep53.net/">p53 compounds</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="data-preprocessing.html"><a href="data-preprocessing.html"><i class="fa fa-check"></i><b>2</b> Data Preprocessing</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-preprocessing.html"><a href="data-preprocessing.html#rna-seq-data"><i class="fa fa-check"></i><b>2.1</b> RNA-seq data</a></li>
<li class="chapter" data-level="2.2" data-path="data-preprocessing.html"><a href="data-preprocessing.html#geo-data"><i class="fa fa-check"></i><b>2.2</b> GEO data</a></li>
<li class="chapter" data-level="2.3" data-path="data-preprocessing.html"><a href="data-preprocessing.html#source-data"><i class="fa fa-check"></i><b>2.3</b> Source data</a></li>
<li class="chapter" data-level="2.4" data-path="data-preprocessing.html"><a href="data-preprocessing.html#tcga-data"><i class="fa fa-check"></i><b>2.4</b> TCGA data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="target-evaluation.html"><a href="target-evaluation.html"><i class="fa fa-check"></i><b>3</b> Target Evaluation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="target-evaluation.html"><a href="target-evaluation.html#load-packages"><i class="fa fa-check"></i><b>3.1</b> Load packages</a></li>
<li class="chapter" data-level="3.2" data-path="target-evaluation.html"><a href="target-evaluation.html#merge-profiling"><i class="fa fa-check"></i><b>3.2</b> Merge profiling</a></li>
<li class="chapter" data-level="3.3" data-path="target-evaluation.html"><a href="target-evaluation.html#normalization"><i class="fa fa-check"></i><b>3.3</b> Normalization</a></li>
<li class="chapter" data-level="3.4" data-path="target-evaluation.html"><a href="target-evaluation.html#confident-p53-targets"><i class="fa fa-check"></i><b>3.4</b> 32 confident p53 targets</a></li>
<li class="chapter" data-level="3.5" data-path="target-evaluation.html"><a href="target-evaluation.html#p53-targets"><i class="fa fa-check"></i><b>3.5</b> 116 p53 targets</a></li>
<li class="chapter" data-level="3.6" data-path="target-evaluation.html"><a href="target-evaluation.html#p53-transactivation"><i class="fa fa-check"></i><b>3.6</b> p53 transactivation</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="enrichment-analysis.html"><a href="enrichment-analysis.html"><i class="fa fa-check"></i><b>4</b> Enrichment analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="enrichment-analysis.html"><a href="enrichment-analysis.html#calculated-degs"><i class="fa fa-check"></i><b>4.1</b> Calculated DEGs</a></li>
<li class="chapter" data-level="4.2" data-path="enrichment-analysis.html"><a href="enrichment-analysis.html#enrichr-analysis"><i class="fa fa-check"></i><b>4.2</b> Enrichr analysis</a></li>
<li class="chapter" data-level="4.3" data-path="enrichment-analysis.html"><a href="enrichment-analysis.html#msigdb-hallmark"><i class="fa fa-check"></i><b>4.3</b> MSigDB Hallmark</a></li>
<li class="chapter" data-level="4.4" data-path="enrichment-analysis.html"><a href="enrichment-analysis.html#kegg"><i class="fa fa-check"></i><b>4.4</b> KEGG</a></li>
<li class="chapter" data-level="4.5" data-path="enrichment-analysis.html"><a href="enrichment-analysis.html#trrust"><i class="fa fa-check"></i><b>4.5</b> TRRUST</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="cmap-database.html"><a href="cmap-database.html"><i class="fa fa-check"></i><b>5</b> CMAP database</a></li>
<li class="chapter" data-level="6" data-path="tcga-pancanatlas.html"><a href="tcga-pancanatlas.html"><i class="fa fa-check"></i><b>6</b> TCGA PanCanAtlas</a>
<ul>
<li class="chapter" data-level="6.1" data-path="tcga-pancanatlas.html"><a href="tcga-pancanatlas.html#wt-up-genes"><i class="fa fa-check"></i><b>6.1</b> WT-up genes</a></li>
<li class="chapter" data-level="6.2" data-path="tcga-pancanatlas.html"><a href="tcga-pancanatlas.html#mut-up-genes"><i class="fa fa-check"></i><b>6.2</b> MUT-up genes</a></li>
<li class="chapter" data-level="6.3" data-path="tcga-pancanatlas.html"><a href="tcga-pancanatlas.html#hr-of-high-expression"><i class="fa fa-check"></i><b>6.3</b> HR of high expression</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="tcga-pancanatlas.html"><a href="tcga-pancanatlas.html#p53-targets-1"><i class="fa fa-check"></i><b>6.3.1</b> 116 p53 targets</a></li>
<li class="chapter" data-level="6.3.2" data-path="tcga-pancanatlas.html"><a href="tcga-pancanatlas.html#wt-up-genes-1"><i class="fa fa-check"></i><b>6.3.2</b> WT-up genes</a></li>
<li class="chapter" data-level="6.3.3" data-path="tcga-pancanatlas.html"><a href="tcga-pancanatlas.html#mut-up-genes-1"><i class="fa fa-check"></i><b>6.3.3</b> MUT-up genes</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="tcga-pancanatlas.html"><a href="tcga-pancanatlas.html#powerfulness-in-regulating"><i class="fa fa-check"></i><b>6.4</b> Powerfulness in regulating</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="tcga-pancanatlas.html"><a href="tcga-pancanatlas.html#p53-targets-2"><i class="fa fa-check"></i><b>6.4.1</b> 116 p53 targets</a></li>
<li class="chapter" data-level="6.4.2" data-path="tcga-pancanatlas.html"><a href="tcga-pancanatlas.html#wt-up-genes-2"><i class="fa fa-check"></i><b>6.4.2</b> WT-up genes</a></li>
<li class="chapter" data-level="6.4.3" data-path="tcga-pancanatlas.html"><a href="tcga-pancanatlas.html#mut-up-genes-2"><i class="fa fa-check"></i><b>6.4.3</b> MUT-up genes</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="tcga-pancanatlas.html"><a href="tcga-pancanatlas.html#hr-for-p53-mutations"><i class="fa fa-check"></i><b>6.5</b> HR for p53 mutations</a></li>
<li class="chapter" data-level="6.6" data-path="tcga-pancanatlas.html"><a href="tcga-pancanatlas.html#mdm2-expression"><i class="fa fa-check"></i><b>6.6</b> MDM2 expression</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="tcga-pancanatlas.html"><a href="tcga-pancanatlas.html#radar-plot"><i class="fa fa-check"></i><b>6.6.1</b> Radar plot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="about-this-project.html"><a href="about-this-project.html"><i class="fa fa-check"></i><b>7</b> About this project</a>
<ul>
<li class="chapter" data-level="" data-path="about-this-project.html"><a href="about-this-project.html#current-version"><i class="fa fa-check"></i>Current version</a></li>
<li class="chapter" data-level="" data-path="about-this-project.html"><a href="about-this-project.html#session-information"><i class="fa fa-check"></i>Session Information</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">p53 compounds</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tcga-pancanatlas" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> TCGA PanCanAtlas<a href="tcga-pancanatlas.html#tcga-pancanatlas" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div style="text-align: center;">
<p><img width="700" src="figures/p53-signatures.png"></p>
</div>
<p>p53 signature genes were defined as followed.</p>
<p><strong>p53 targets</strong>: The 116 p53 targets.</p>
<p><strong>WT-up gene</strong>: in at least five cohorts, expression of this gene in the samples harboring wild-type p53 is significantly higher than expression of this gene in the samples harboring highly frequent p53 mutations (Significance: fold change &gt; 1.5 &amp; adjust P &lt; 0.05; highly frequent mutations are the ones reliably inactivate p53 wild-type functions: the missense/frameshift/insertion/deletion/stop-gain/splicing mutations with &gt; 0.5% frequency).</p>
<p><strong>MUT-up gene</strong>: in at least five cohorts, expression of this gene in the samples harboring highly frequent p53 missense mutations is significantly higher than expression of this gene in the samples harboring wild-type p53 (Significance: fold change &gt; 1.5 &amp; adjust P &lt; 0.05; highly frequent missense mutations are the ones most likely possessing of GOF: the missense mutations with &gt; 0.5% frequency).</p>
<div id="wt-up-genes" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> WT-up genes<a href="tcga-pancanatlas.html#wt-up-genes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="tcga-pancanatlas.html#cb22-1" tabindex="-1"></a><span class="co"># DEGs between p53 mut (top mutations) and p53 wt </span></span>
<span id="cb22-2"><a href="tcga-pancanatlas.html#cb22-2" tabindex="-1"></a></span>
<span id="cb22-3"><a href="tcga-pancanatlas.html#cb22-3" tabindex="-1"></a>enroll.data <span class="ot">&lt;-</span> tcga.mutation.tp53[tcga.mutation.tp53<span class="sc">$</span>Amino_Acid_Change <span class="sc">%in%</span> tp53.mut.topall<span class="sc">$</span>Mutation, ]</span>
<span id="cb22-4"><a href="tcga-pancanatlas.html#cb22-4" tabindex="-1"></a></span>
<span id="cb22-5"><a href="tcga-pancanatlas.html#cb22-5" tabindex="-1"></a></span>
<span id="cb22-6"><a href="tcga-pancanatlas.html#cb22-6" tabindex="-1"></a>total.deg <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb22-7"><a href="tcga-pancanatlas.html#cb22-7" tabindex="-1"></a><span class="cf">for</span> (kkk <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(TCGA.ALL)) {</span>
<span id="cb22-8"><a href="tcga-pancanatlas.html#cb22-8" tabindex="-1"></a>  pdata <span class="ot">&lt;-</span> tcga.meta</span>
<span id="cb22-9"><a href="tcga-pancanatlas.html#cb22-9" tabindex="-1"></a>  <span class="fu">sum</span>(pdata<span class="sc">$</span>sample <span class="sc">!=</span> <span class="fu">colnames</span>(tcga.fpkm))</span>
<span id="cb22-10"><a href="tcga-pancanatlas.html#cb22-10" tabindex="-1"></a>  </span>
<span id="cb22-11"><a href="tcga-pancanatlas.html#cb22-11" tabindex="-1"></a>  pdata<span class="sc">$</span>contrast <span class="ot">&lt;-</span> <span class="st">&quot;other&quot;</span></span>
<span id="cb22-12"><a href="tcga-pancanatlas.html#cb22-12" tabindex="-1"></a>  pdata<span class="sc">$</span>contrast[<span class="fu">which</span>(pdata<span class="sc">$</span>TP53mut <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span> <span class="sc">&amp;</span> pdata<span class="sc">$</span>project_id <span class="sc">==</span> TCGA.ALL[kkk] <span class="sc">&amp;</span> pdata<span class="sc">$</span>sample <span class="sc">%in%</span> enroll.data<span class="sc">$</span>Sample_ID)] <span class="ot">&lt;-</span> <span class="st">&quot;c2&quot;</span></span>
<span id="cb22-13"><a href="tcga-pancanatlas.html#cb22-13" tabindex="-1"></a>  pdata<span class="sc">$</span>contrast[<span class="fu">which</span>(pdata<span class="sc">$</span>TP53mut <span class="sc">==</span> <span class="st">&quot;No&quot;</span> <span class="sc">&amp;</span> pdata<span class="sc">$</span>project_id <span class="sc">==</span> TCGA.ALL[kkk] <span class="sc">&amp;</span> pdata<span class="sc">$</span>WithMutation <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;c1&quot;</span></span>
<span id="cb22-14"><a href="tcga-pancanatlas.html#cb22-14" tabindex="-1"></a>  </span>
<span id="cb22-15"><a href="tcga-pancanatlas.html#cb22-15" tabindex="-1"></a>  <span class="fu">message</span>(kkk, <span class="st">&quot;  &quot;</span>, TCGA.ALL[kkk], <span class="st">&quot;   &quot;</span>, <span class="fu">sum</span>(pdata<span class="sc">$</span>contrast <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;c1&quot;</span>)), <span class="st">&quot;   &quot;</span>, <span class="fu">sum</span>(pdata<span class="sc">$</span>contrast <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;c2&quot;</span>)) )</span>
<span id="cb22-16"><a href="tcga-pancanatlas.html#cb22-16" tabindex="-1"></a>  </span>
<span id="cb22-17"><a href="tcga-pancanatlas.html#cb22-17" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(<span class="fu">unique</span>(pdata<span class="sc">$</span>contrast)) <span class="sc">==</span> <span class="dv">3</span> <span class="sc">&amp;</span> <span class="fu">sum</span>(<span class="fu">table</span>(pdata<span class="sc">$</span>contrast) <span class="sc">&lt;</span> <span class="dv">1</span>) <span class="sc">==</span> <span class="dv">0</span> ) {</span>
<span id="cb22-18"><a href="tcga-pancanatlas.html#cb22-18" tabindex="-1"></a>    pdata.sub <span class="ot">&lt;-</span> pdata[<span class="fu">which</span>(pdata<span class="sc">$</span>contrast <span class="sc">!=</span> <span class="st">&quot;other&quot;</span>), ]</span>
<span id="cb22-19"><a href="tcga-pancanatlas.html#cb22-19" tabindex="-1"></a>    design <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> <span class="fu">as.factor</span>(contrast), <span class="at">data =</span> pdata.sub)</span>
<span id="cb22-20"><a href="tcga-pancanatlas.html#cb22-20" tabindex="-1"></a>    <span class="fu">colnames</span>(design) <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(<span class="fu">colnames</span>(design), <span class="fu">fixed</span>(<span class="st">&quot;as.factor(contrast)&quot;</span>), <span class="st">&quot;&quot;</span>)</span>
<span id="cb22-21"><a href="tcga-pancanatlas.html#cb22-21" tabindex="-1"></a>    contrast <span class="ot">&lt;-</span> <span class="fu">makeContrasts</span>(<span class="at">c1_c2 =</span> c1 <span class="sc">-</span> c2, <span class="at">levels =</span> design)</span>
<span id="cb22-22"><a href="tcga-pancanatlas.html#cb22-22" tabindex="-1"></a>    fits <span class="ot">&lt;-</span> <span class="fu">contrasts.fit</span>(fit, contrast)</span>
<span id="cb22-23"><a href="tcga-pancanatlas.html#cb22-23" tabindex="-1"></a>    ebFit <span class="ot">&lt;-</span> <span class="fu">eBayes</span>(fits)</span>
<span id="cb22-24"><a href="tcga-pancanatlas.html#cb22-24" tabindex="-1"></a>    deg_sig_list <span class="ot">&lt;-</span> <span class="fu">topTable</span>(ebFit, <span class="at">coef =</span> <span class="dv">1</span>, <span class="at">adjust.method =</span> <span class="st">&#39;fdr&#39;</span>, <span class="at">number =</span> <span class="cn">Inf</span>)</span>
<span id="cb22-25"><a href="tcga-pancanatlas.html#cb22-25" tabindex="-1"></a>    deg.data <span class="ot">&lt;-</span> deg_sig_list[<span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(deg_sig_list<span class="sc">$</span>P.Value)), ]</span>
<span id="cb22-26"><a href="tcga-pancanatlas.html#cb22-26" tabindex="-1"></a>    deg.data<span class="sc">$</span>logP <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log10</span>(deg.data<span class="sc">$</span>P.Value)</span>
<span id="cb22-27"><a href="tcga-pancanatlas.html#cb22-27" tabindex="-1"></a>    deg.data<span class="sc">$</span>logFDR <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log10</span>(deg.data<span class="sc">$</span>adj.P.Val)</span>
<span id="cb22-28"><a href="tcga-pancanatlas.html#cb22-28" tabindex="-1"></a>    deg.data<span class="sc">$</span>group <span class="ot">=</span> <span class="st">&quot;zz&quot;</span></span>
<span id="cb22-29"><a href="tcga-pancanatlas.html#cb22-29" tabindex="-1"></a>    deg.data<span class="sc">$</span>group[<span class="fu">which</span>( (deg.data<span class="sc">$</span>adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">&amp;</span> (deg.data<span class="sc">$</span>logFC <span class="sc">&gt;</span> <span class="fl">0.58</span>) )] <span class="ot">=</span> <span class="st">&quot;up&quot;</span></span>
<span id="cb22-30"><a href="tcga-pancanatlas.html#cb22-30" tabindex="-1"></a>    deg.data<span class="sc">$</span>group[<span class="fu">which</span>( (deg.data<span class="sc">$</span>adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">&amp;</span> (deg.data<span class="sc">$</span>logFC <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">0.58</span>) )] <span class="ot">=</span> <span class="st">&quot;down&quot;</span></span>
<span id="cb22-31"><a href="tcga-pancanatlas.html#cb22-31" tabindex="-1"></a>    deg.data<span class="sc">$</span>tag <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;TP53 wt -vs- mut&quot;</span>)</span>
<span id="cb22-32"><a href="tcga-pancanatlas.html#cb22-32" tabindex="-1"></a>    deg.data<span class="sc">$</span>Gene <span class="ot">&lt;-</span> <span class="fu">rownames</span>(deg.data)</span>
<span id="cb22-33"><a href="tcga-pancanatlas.html#cb22-33" tabindex="-1"></a>    deg.data<span class="sc">$</span>Cohort <span class="ot">&lt;-</span> TCGA.ALL[kkk]</span>
<span id="cb22-34"><a href="tcga-pancanatlas.html#cb22-34" tabindex="-1"></a>    deg.data <span class="ot">&lt;-</span> deg.data[<span class="fu">which</span>(deg.data<span class="sc">$</span>group <span class="sc">!=</span> <span class="st">&quot;zz&quot;</span>), ]</span>
<span id="cb22-35"><a href="tcga-pancanatlas.html#cb22-35" tabindex="-1"></a>    total.deg <span class="ot">&lt;-</span> <span class="fu">rbind</span>(total.deg, deg.data)</span>
<span id="cb22-36"><a href="tcga-pancanatlas.html#cb22-36" tabindex="-1"></a>}</span>
<span id="cb22-37"><a href="tcga-pancanatlas.html#cb22-37" tabindex="-1"></a></span>
<span id="cb22-38"><a href="tcga-pancanatlas.html#cb22-38" tabindex="-1"></a>total.deg<span class="sc">$</span>Cohort <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(total.deg<span class="sc">$</span>Cohort), <span class="at">levels =</span> TCGA.ALL)</span>
<span id="cb22-39"><a href="tcga-pancanatlas.html#cb22-39" tabindex="-1"></a><span class="fu">saveRDS</span>(total.deg, <span class="st">&quot;02.tcga/degs_tp53_wtup_top.rds&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="tcga-pancanatlas.html#cb23-1" tabindex="-1"></a>total.deg.wtup <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;02.tcga/degs_tp53_wtup_top.rds&quot;</span>)</span>
<span id="cb23-2"><a href="tcga-pancanatlas.html#cb23-2" tabindex="-1"></a></span>
<span id="cb23-3"><a href="tcga-pancanatlas.html#cb23-3" tabindex="-1"></a>tp53.wtup.top <span class="ot">&lt;-</span> <span class="fu">table</span>(total.deg.wtup[, <span class="fu">c</span>(<span class="st">&quot;Gene&quot;</span>,<span class="st">&quot;Cohort&quot;</span>)])</span>
<span id="cb23-4"><a href="tcga-pancanatlas.html#cb23-4" tabindex="-1"></a>tp53.wtup.top <span class="ot">&lt;-</span> tp53.wtup.top[<span class="fu">order</span>(<span class="fu">rowSums</span>(tp53.wtup.top), <span class="at">decreasing =</span> T), ]</span>
<span id="cb23-5"><a href="tcga-pancanatlas.html#cb23-5" tabindex="-1"></a><span class="fu">dim</span>(tp53.wtup.top)</span></code></pre></div>
<pre><code>## [1] 5694   33</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="tcga-pancanatlas.html#cb25-1" tabindex="-1"></a>plot.data <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb25-2"><a href="tcga-pancanatlas.html#cb25-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb25-3"><a href="tcga-pancanatlas.html#cb25-3" tabindex="-1"></a>  sub <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Var1 =</span> i, <span class="at">Freq =</span> <span class="fu">sum</span>(<span class="fu">rowSums</span>(tp53.wtup.top) <span class="sc">&gt;=</span> i))</span>
<span id="cb25-4"><a href="tcga-pancanatlas.html#cb25-4" tabindex="-1"></a>  plot.data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(plot.data, sub)</span>
<span id="cb25-5"><a href="tcga-pancanatlas.html#cb25-5" tabindex="-1"></a>}</span>
<span id="cb25-6"><a href="tcga-pancanatlas.html#cb25-6" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggbarplot</span>(plot.data, <span class="at">x =</span> <span class="st">&quot;Var1&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Freq&quot;</span>,</span>
<span id="cb25-7"><a href="tcga-pancanatlas.html#cb25-7" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">0</span>,</span>
<span id="cb25-8"><a href="tcga-pancanatlas.html#cb25-8" tabindex="-1"></a>               <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">lab.pos =</span> <span class="fu">c</span>(<span class="st">&quot;out&quot;</span>), <span class="at">lab.size =</span> <span class="dv">4</span>,</span>
<span id="cb25-9"><a href="tcga-pancanatlas.html#cb25-9" tabindex="-1"></a>               <span class="at">lab.vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, </span>
<span id="cb25-10"><a href="tcga-pancanatlas.html#cb25-10" tabindex="-1"></a>               <span class="at">lab.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb25-11"><a href="tcga-pancanatlas.html#cb25-11" tabindex="-1"></a>               <span class="at">main =</span> <span class="st">&quot;The p53 WT-up genes&quot;</span>,</span>
<span id="cb25-12"><a href="tcga-pancanatlas.html#cb25-12" tabindex="-1"></a>               <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Gene Count&quot;</span>)</span>
<span id="cb25-13"><a href="tcga-pancanatlas.html#cb25-13" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">theme_base</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.background =</span> <span class="fu">element_blank</span>())</span>
<span id="cb25-14"><a href="tcga-pancanatlas.html#cb25-14" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="p53-compounds_files/figure-html/unnamed-chunk-19-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="tcga-pancanatlas.html#cb26-1" tabindex="-1"></a>gene.tp53.wtup.top <span class="ot">&lt;-</span> <span class="fu">row.names</span>(tp53.wtup.top[<span class="fu">rowSums</span>(tp53.wtup.top) <span class="sc">&gt;=</span> <span class="dv">5</span>, ])</span>
<span id="cb26-2"><a href="tcga-pancanatlas.html#cb26-2" tabindex="-1"></a><span class="fu">length</span>(gene.tp53.wtup.top)</span></code></pre></div>
<pre><code>## [1] 157</code></pre>
</div>
<div id="mut-up-genes" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> MUT-up genes<a href="tcga-pancanatlas.html#mut-up-genes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="tcga-pancanatlas.html#cb28-1" tabindex="-1"></a><span class="co"># DEGs between p53 mut (top missense mutations) and p53 wt </span></span>
<span id="cb28-2"><a href="tcga-pancanatlas.html#cb28-2" tabindex="-1"></a></span>
<span id="cb28-3"><a href="tcga-pancanatlas.html#cb28-3" tabindex="-1"></a>enroll.data <span class="ot">&lt;-</span> tcga.mutation.tp53[tcga.mutation.tp53<span class="sc">$</span>Amino_Acid_Change <span class="sc">%in%</span> tp53.mut.topmis<span class="sc">$</span>Mutation, ]</span>
<span id="cb28-4"><a href="tcga-pancanatlas.html#cb28-4" tabindex="-1"></a><span class="fu">table</span>(enroll.data<span class="sc">$</span>Class)</span>
<span id="cb28-5"><a href="tcga-pancanatlas.html#cb28-5" tabindex="-1"></a></span>
<span id="cb28-6"><a href="tcga-pancanatlas.html#cb28-6" tabindex="-1"></a>total.deg <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb28-7"><a href="tcga-pancanatlas.html#cb28-7" tabindex="-1"></a><span class="cf">for</span> (kkk <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(TCGA.ALL)) {</span>
<span id="cb28-8"><a href="tcga-pancanatlas.html#cb28-8" tabindex="-1"></a>  pdata <span class="ot">&lt;-</span> tcga.meta</span>
<span id="cb28-9"><a href="tcga-pancanatlas.html#cb28-9" tabindex="-1"></a>  <span class="fu">sum</span>(pdata<span class="sc">$</span>sample <span class="sc">!=</span> <span class="fu">colnames</span>(tcga.fpkm))</span>
<span id="cb28-10"><a href="tcga-pancanatlas.html#cb28-10" tabindex="-1"></a>  </span>
<span id="cb28-11"><a href="tcga-pancanatlas.html#cb28-11" tabindex="-1"></a>  pdata<span class="sc">$</span>contrast <span class="ot">&lt;-</span> <span class="st">&quot;other&quot;</span></span>
<span id="cb28-12"><a href="tcga-pancanatlas.html#cb28-12" tabindex="-1"></a>  pdata<span class="sc">$</span>contrast[<span class="fu">which</span>(pdata<span class="sc">$</span>TP53mut <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span> <span class="sc">&amp;</span> pdata<span class="sc">$</span>project_id <span class="sc">==</span> TCGA.ALL[kkk] <span class="sc">&amp;</span> pdata<span class="sc">$</span>sample <span class="sc">%in%</span> enroll.data<span class="sc">$</span>Sample_ID)] <span class="ot">&lt;-</span> <span class="st">&quot;c1&quot;</span></span>
<span id="cb28-13"><a href="tcga-pancanatlas.html#cb28-13" tabindex="-1"></a>  pdata<span class="sc">$</span>contrast[<span class="fu">which</span>(pdata<span class="sc">$</span>TP53mut <span class="sc">==</span> <span class="st">&quot;No&quot;</span> <span class="sc">&amp;</span> pdata<span class="sc">$</span>project_id <span class="sc">==</span> TCGA.ALL[kkk] <span class="sc">&amp;</span> pdata<span class="sc">$</span>WithMutation <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;c2&quot;</span></span>
<span id="cb28-14"><a href="tcga-pancanatlas.html#cb28-14" tabindex="-1"></a>  </span>
<span id="cb28-15"><a href="tcga-pancanatlas.html#cb28-15" tabindex="-1"></a>  <span class="fu">message</span>(kkk, <span class="st">&quot;  &quot;</span>, TCGA.ALL[kkk], <span class="st">&quot;   &quot;</span>, <span class="fu">sum</span>(pdata<span class="sc">$</span>contrast <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;c1&quot;</span>)), <span class="st">&quot;   &quot;</span>, <span class="fu">sum</span>(pdata<span class="sc">$</span>contrast <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;c2&quot;</span>)) )</span>
<span id="cb28-16"><a href="tcga-pancanatlas.html#cb28-16" tabindex="-1"></a>  </span>
<span id="cb28-17"><a href="tcga-pancanatlas.html#cb28-17" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(<span class="fu">unique</span>(pdata<span class="sc">$</span>contrast)) <span class="sc">==</span> <span class="dv">3</span> <span class="sc">&amp;</span> <span class="fu">sum</span>(<span class="fu">table</span>(pdata<span class="sc">$</span>contrast) <span class="sc">&lt;</span> <span class="dv">1</span>) <span class="sc">==</span> <span class="dv">0</span> ) {</span>
<span id="cb28-18"><a href="tcga-pancanatlas.html#cb28-18" tabindex="-1"></a>    pdata.sub <span class="ot">&lt;-</span> pdata[<span class="fu">which</span>(pdata<span class="sc">$</span>contrast <span class="sc">!=</span> <span class="st">&quot;other&quot;</span>), ]</span>
<span id="cb28-19"><a href="tcga-pancanatlas.html#cb28-19" tabindex="-1"></a>    design <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> <span class="fu">as.factor</span>(contrast), <span class="at">data =</span> pdata.sub)</span>
<span id="cb28-20"><a href="tcga-pancanatlas.html#cb28-20" tabindex="-1"></a>    <span class="fu">colnames</span>(design) <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(<span class="fu">colnames</span>(design), <span class="fu">fixed</span>(<span class="st">&quot;as.factor(contrast)&quot;</span>), <span class="st">&quot;&quot;</span>)</span>
<span id="cb28-21"><a href="tcga-pancanatlas.html#cb28-21" tabindex="-1"></a>    contrast <span class="ot">&lt;-</span> <span class="fu">makeContrasts</span>(<span class="at">c1_c2 =</span> c1 <span class="sc">-</span> c2, <span class="at">levels =</span> design)</span>
<span id="cb28-22"><a href="tcga-pancanatlas.html#cb28-22" tabindex="-1"></a>    fits <span class="ot">&lt;-</span> <span class="fu">contrasts.fit</span>(fit, contrast)</span>
<span id="cb28-23"><a href="tcga-pancanatlas.html#cb28-23" tabindex="-1"></a>    ebFit <span class="ot">&lt;-</span> <span class="fu">eBayes</span>(fits)</span>
<span id="cb28-24"><a href="tcga-pancanatlas.html#cb28-24" tabindex="-1"></a>    deg_sig_list <span class="ot">&lt;-</span> <span class="fu">topTable</span>(ebFit, <span class="at">coef =</span> <span class="dv">1</span>, <span class="at">adjust.method =</span> <span class="st">&#39;fdr&#39;</span>, <span class="at">number =</span> <span class="cn">Inf</span>)</span>
<span id="cb28-25"><a href="tcga-pancanatlas.html#cb28-25" tabindex="-1"></a>    deg.data <span class="ot">&lt;-</span> deg_sig_list[<span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(deg_sig_list<span class="sc">$</span>P.Value)), ]</span>
<span id="cb28-26"><a href="tcga-pancanatlas.html#cb28-26" tabindex="-1"></a>    deg.data<span class="sc">$</span>logP <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log10</span>(deg.data<span class="sc">$</span>P.Value)</span>
<span id="cb28-27"><a href="tcga-pancanatlas.html#cb28-27" tabindex="-1"></a>    deg.data<span class="sc">$</span>logFDR <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log10</span>(deg.data<span class="sc">$</span>adj.P.Val)</span>
<span id="cb28-28"><a href="tcga-pancanatlas.html#cb28-28" tabindex="-1"></a>    deg.data<span class="sc">$</span>group <span class="ot">=</span> <span class="st">&quot;zz&quot;</span></span>
<span id="cb28-29"><a href="tcga-pancanatlas.html#cb28-29" tabindex="-1"></a>    deg.data<span class="sc">$</span>group[<span class="fu">which</span>( (deg.data<span class="sc">$</span>adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">&amp;</span> (deg.data<span class="sc">$</span>logFC <span class="sc">&gt;</span> <span class="fl">0.58</span>) )] <span class="ot">=</span> <span class="st">&quot;up&quot;</span></span>
<span id="cb28-30"><a href="tcga-pancanatlas.html#cb28-30" tabindex="-1"></a>    deg.data<span class="sc">$</span>group[<span class="fu">which</span>( (deg.data<span class="sc">$</span>adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">&amp;</span> (deg.data<span class="sc">$</span>logFC <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">0.58</span>) )] <span class="ot">=</span> <span class="st">&quot;down&quot;</span></span>
<span id="cb28-31"><a href="tcga-pancanatlas.html#cb28-31" tabindex="-1"></a>    deg.data<span class="sc">$</span>tag <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;TP53 mut -vs- wt&quot;</span>)</span>
<span id="cb28-32"><a href="tcga-pancanatlas.html#cb28-32" tabindex="-1"></a>    deg.data<span class="sc">$</span>Gene <span class="ot">&lt;-</span> <span class="fu">rownames</span>(deg.data)</span>
<span id="cb28-33"><a href="tcga-pancanatlas.html#cb28-33" tabindex="-1"></a>    deg.data<span class="sc">$</span>Cohort <span class="ot">&lt;-</span> TCGA.ALL[kkk]</span>
<span id="cb28-34"><a href="tcga-pancanatlas.html#cb28-34" tabindex="-1"></a>    deg.data <span class="ot">&lt;-</span> deg.data[<span class="fu">which</span>(deg.data<span class="sc">$</span>group <span class="sc">!=</span> <span class="st">&quot;zz&quot;</span>), ]</span>
<span id="cb28-35"><a href="tcga-pancanatlas.html#cb28-35" tabindex="-1"></a>    total.deg <span class="ot">&lt;-</span> <span class="fu">rbind</span>(total.deg, deg.data)</span>
<span id="cb28-36"><a href="tcga-pancanatlas.html#cb28-36" tabindex="-1"></a>}</span>
<span id="cb28-37"><a href="tcga-pancanatlas.html#cb28-37" tabindex="-1"></a></span>
<span id="cb28-38"><a href="tcga-pancanatlas.html#cb28-38" tabindex="-1"></a>total.deg<span class="sc">$</span>Cohort <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(total.deg<span class="sc">$</span>Cohort), <span class="at">levels =</span> TCGA.ALL)</span>
<span id="cb28-39"><a href="tcga-pancanatlas.html#cb28-39" tabindex="-1"></a><span class="fu">saveRDS</span>(total.deg, <span class="st">&quot;02.tcga/degs_tp53_mutup_top.rds&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="tcga-pancanatlas.html#cb29-1" tabindex="-1"></a>total.deg.mutup <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;02.tcga/degs_tp53_misup_top.rds&quot;</span>)</span>
<span id="cb29-2"><a href="tcga-pancanatlas.html#cb29-2" tabindex="-1"></a></span>
<span id="cb29-3"><a href="tcga-pancanatlas.html#cb29-3" tabindex="-1"></a>tp53.mutup.top <span class="ot">&lt;-</span> <span class="fu">table</span>(total.deg.mutup[, <span class="fu">c</span>(<span class="st">&quot;Gene&quot;</span>,<span class="st">&quot;Cohort&quot;</span>)])</span>
<span id="cb29-4"><a href="tcga-pancanatlas.html#cb29-4" tabindex="-1"></a>tp53.mutup.top <span class="ot">&lt;-</span> tp53.mutup.top[<span class="fu">order</span>(<span class="fu">rowSums</span>(tp53.mutup.top), <span class="at">decreasing =</span> T), ]</span>
<span id="cb29-5"><a href="tcga-pancanatlas.html#cb29-5" tabindex="-1"></a><span class="fu">dim</span>(tp53.mutup.top)</span></code></pre></div>
<pre><code>## [1] 5498   33</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="tcga-pancanatlas.html#cb31-1" tabindex="-1"></a>plot.data <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb31-2"><a href="tcga-pancanatlas.html#cb31-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb31-3"><a href="tcga-pancanatlas.html#cb31-3" tabindex="-1"></a>  sub <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Var1 =</span> i, <span class="at">Freq =</span> <span class="fu">sum</span>(<span class="fu">rowSums</span>(tp53.mutup.top) <span class="sc">&gt;=</span> i))</span>
<span id="cb31-4"><a href="tcga-pancanatlas.html#cb31-4" tabindex="-1"></a>  plot.data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(plot.data, sub)</span>
<span id="cb31-5"><a href="tcga-pancanatlas.html#cb31-5" tabindex="-1"></a>}</span>
<span id="cb31-6"><a href="tcga-pancanatlas.html#cb31-6" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggbarplot</span>(plot.data, <span class="at">x =</span> <span class="st">&quot;Var1&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Freq&quot;</span>,</span>
<span id="cb31-7"><a href="tcga-pancanatlas.html#cb31-7" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">0</span>,</span>
<span id="cb31-8"><a href="tcga-pancanatlas.html#cb31-8" tabindex="-1"></a>               <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">lab.pos =</span> <span class="fu">c</span>(<span class="st">&quot;out&quot;</span>), <span class="at">lab.size =</span> <span class="dv">4</span>,</span>
<span id="cb31-9"><a href="tcga-pancanatlas.html#cb31-9" tabindex="-1"></a>               <span class="at">lab.vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, </span>
<span id="cb31-10"><a href="tcga-pancanatlas.html#cb31-10" tabindex="-1"></a>               <span class="at">lab.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb31-11"><a href="tcga-pancanatlas.html#cb31-11" tabindex="-1"></a>               <span class="at">main =</span> <span class="st">&quot;The p53 WT-up genes&quot;</span>,</span>
<span id="cb31-12"><a href="tcga-pancanatlas.html#cb31-12" tabindex="-1"></a>               <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Gene Count&quot;</span>)</span>
<span id="cb31-13"><a href="tcga-pancanatlas.html#cb31-13" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">theme_base</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.background =</span> <span class="fu">element_blank</span>())</span>
<span id="cb31-14"><a href="tcga-pancanatlas.html#cb31-14" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="p53-compounds_files/figure-html/unnamed-chunk-21-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="tcga-pancanatlas.html#cb32-1" tabindex="-1"></a>gene.tp53.mutup.top <span class="ot">&lt;-</span> <span class="fu">row.names</span>(tp53.mutup.top[<span class="fu">rowSums</span>(tp53.mutup.top) <span class="sc">&gt;=</span> <span class="dv">5</span>, ])</span>
<span id="cb32-2"><a href="tcga-pancanatlas.html#cb32-2" tabindex="-1"></a><span class="fu">length</span>(gene.tp53.mutup.top)</span></code></pre></div>
<pre><code>## [1] 140</code></pre>
</div>
<div id="hr-of-high-expression" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> HR of high expression<a href="tcga-pancanatlas.html#hr-of-high-expression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>HR of high expression of p53 signature genes among TCGA cancer types.</p>
<div id="p53-targets-1" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> 116 p53 targets<a href="tcga-pancanatlas.html#p53-targets-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>HR of high expression of the 116 p53 targets among 33 TCGA cancer cohorts. In each cohort, patients are separated by the median value of gene expression, followed by HR values calculation using the univariable Cox regression analysis.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="tcga-pancanatlas.html#cb34-1" tabindex="-1"></a>TCGA.ALL <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;TCGA-OV&quot;</span>,<span class="st">&quot;TCGA-UCS&quot;</span>,<span class="st">&quot;TCGA-LUSC&quot;</span>,<span class="st">&quot;TCGA-ESCA&quot;</span>,<span class="st">&quot;TCGA-READ&quot;</span>,<span class="st">&quot;TCGA-HNSC&quot;</span>,<span class="st">&quot;TCGA-PAAD&quot;</span>,<span class="st">&quot;TCGA-COAD&quot;</span>,<span class="st">&quot;TCGA-LUAD&quot;</span>,<span class="st">&quot;TCGA-BLCA&quot;</span>,<span class="st">&quot;TCGA-STAD&quot;</span>,<span class="st">&quot;TCGA-LGG&quot;</span>,<span class="st">&quot;TCGA-UCEC&quot;</span>,<span class="st">&quot;TCGA-SARC&quot;</span>,<span class="st">&quot;TCGA-BRCA&quot;</span>,<span class="st">&quot;TCGA-GBM&quot;</span>,<span class="st">&quot;TCGA-LIHC&quot;</span>,<span class="st">&quot;TCGA-KICH&quot;</span>,<span class="st">&quot;TCGA-ACC&quot;</span>,<span class="st">&quot;TCGA-MESO&quot;</span>,<span class="st">&quot;TCGA-DLBC&quot;</span>,<span class="st">&quot;TCGA-PRAD&quot;</span>,<span class="st">&quot;TCGA-CHOL&quot;</span>,<span class="st">&quot;TCGA-SKCM&quot;</span>,<span class="st">&quot;TCGA-CESC&quot;</span>,<span class="st">&quot;TCGA-LAML&quot;</span>,<span class="st">&quot;TCGA-THYM&quot;</span>,<span class="st">&quot;TCGA-KIRC&quot;</span>,<span class="st">&quot;TCGA-KIRP&quot;</span>,<span class="st">&quot;TCGA-TGCT&quot;</span>,<span class="st">&quot;TCGA-THCA&quot;</span>,<span class="st">&quot;TCGA-PCPG&quot;</span>,<span class="st">&quot;TCGA-UVM&quot;</span>)</span>
<span id="cb34-2"><a href="tcga-pancanatlas.html#cb34-2" tabindex="-1"></a></span>
<span id="cb34-3"><a href="tcga-pancanatlas.html#cb34-3" tabindex="-1"></a>plot.data <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">&quot;02.tcga/Table6.xlsx&quot;</span>, <span class="at">sheet =</span> <span class="dv">1</span>, <span class="at">startRow =</span> <span class="dv">2</span>)</span>
<span id="cb34-4"><a href="tcga-pancanatlas.html#cb34-4" tabindex="-1"></a></span>
<span id="cb34-5"><a href="tcga-pancanatlas.html#cb34-5" tabindex="-1"></a>plot.data <span class="ot">&lt;-</span> plot.data[, <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb34-6"><a href="tcga-pancanatlas.html#cb34-6" tabindex="-1"></a>plot.data <span class="ot">&lt;-</span> plot.data[<span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(plot.data<span class="sc">$</span>TCGA.Cohort)), ]</span>
<span id="cb34-7"><a href="tcga-pancanatlas.html#cb34-7" tabindex="-1"></a>gene.list <span class="ot">&lt;-</span> <span class="fu">unique</span>(plot.data<span class="sc">$</span>p53.targets)</span>
<span id="cb34-8"><a href="tcga-pancanatlas.html#cb34-8" tabindex="-1"></a><span class="fu">length</span>(gene.list)</span></code></pre></div>
<pre><code>## [1] 116</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="tcga-pancanatlas.html#cb36-1" tabindex="-1"></a>plot.mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">length</span>(gene.list), <span class="at">ncol =</span> <span class="fu">length</span>(TCGA.ALL))</span>
<span id="cb36-2"><a href="tcga-pancanatlas.html#cb36-2" tabindex="-1"></a><span class="fu">rownames</span>(plot.mat) <span class="ot">&lt;-</span> gene.list</span>
<span id="cb36-3"><a href="tcga-pancanatlas.html#cb36-3" tabindex="-1"></a><span class="fu">colnames</span>(plot.mat) <span class="ot">&lt;-</span> TCGA.ALL</span>
<span id="cb36-4"><a href="tcga-pancanatlas.html#cb36-4" tabindex="-1"></a>plot.mat.hr <span class="ot">&lt;-</span> plot.mat</span>
<span id="cb36-5"><a href="tcga-pancanatlas.html#cb36-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(plot.mat)) {</span>
<span id="cb36-6"><a href="tcga-pancanatlas.html#cb36-6" tabindex="-1"></a>  sub <span class="ot">&lt;-</span> plot.data[<span class="fu">which</span>(plot.data<span class="sc">$</span>TCGA.Cohort <span class="sc">==</span> <span class="fu">colnames</span>(plot.mat)[i]), ]</span>
<span id="cb36-7"><a href="tcga-pancanatlas.html#cb36-7" tabindex="-1"></a>  sub <span class="ot">&lt;-</span> sub[<span class="fu">which</span>(sub<span class="sc">$</span>P.value <span class="sc">&lt;</span> <span class="fl">0.05</span>), ]</span>
<span id="cb36-8"><a href="tcga-pancanatlas.html#cb36-8" tabindex="-1"></a>  plot.mat.hr[<span class="fu">match</span>(sub<span class="sc">$</span>p53.targets, <span class="fu">rownames</span>(plot.mat.hr)), i] <span class="ot">&lt;-</span> <span class="fu">log2</span>(sub<span class="sc">$</span>HR)</span>
<span id="cb36-9"><a href="tcga-pancanatlas.html#cb36-9" tabindex="-1"></a>  sub<span class="fl">.1</span> <span class="ot">&lt;-</span> sub[<span class="fu">which</span>(sub<span class="sc">$</span>P.value <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> sub<span class="sc">$</span>HR <span class="sc">&gt;</span> <span class="dv">1</span>), ]</span>
<span id="cb36-10"><a href="tcga-pancanatlas.html#cb36-10" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(sub<span class="fl">.1</span>) <span class="sc">&gt;</span> <span class="dv">0</span>) plot.mat[<span class="fu">match</span>(sub<span class="fl">.1</span><span class="sc">$</span>p53.targets, <span class="fu">rownames</span>(plot.mat)), i] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb36-11"><a href="tcga-pancanatlas.html#cb36-11" tabindex="-1"></a>  sub<span class="fl">.2</span> <span class="ot">&lt;-</span> sub[<span class="fu">which</span>(sub<span class="sc">$</span>P.value <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> sub<span class="sc">$</span>HR <span class="sc">&lt;</span> <span class="dv">1</span>), ]</span>
<span id="cb36-12"><a href="tcga-pancanatlas.html#cb36-12" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(sub<span class="fl">.2</span>) <span class="sc">&gt;</span> <span class="dv">0</span>) plot.mat[<span class="fu">match</span>(sub<span class="fl">.2</span><span class="sc">$</span>p53.targets, <span class="fu">rownames</span>(plot.mat)), i] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb36-13"><a href="tcga-pancanatlas.html#cb36-13" tabindex="-1"></a>}</span>
<span id="cb36-14"><a href="tcga-pancanatlas.html#cb36-14" tabindex="-1"></a>stat.gene <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Gene =</span> <span class="fu">rownames</span>(plot.mat), </span>
<span id="cb36-15"><a href="tcga-pancanatlas.html#cb36-15" tabindex="-1"></a>                        <span class="at">SigCount =</span> <span class="fu">rowSums</span>(plot.mat <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">-</span> <span class="fu">rowSums</span>(plot.mat <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="cb36-16"><a href="tcga-pancanatlas.html#cb36-16" tabindex="-1"></a>                        <span class="at">SigHR =</span> <span class="fu">rowMeans</span>(plot.mat.hr <span class="sc">*</span> <span class="sc">-</span><span class="dv">1</span>) )</span>
<span id="cb36-17"><a href="tcga-pancanatlas.html#cb36-17" tabindex="-1"></a>stat.gene <span class="ot">&lt;-</span> stat.gene[<span class="fu">order</span>(stat.gene<span class="sc">$</span>SigCount, stat.gene<span class="sc">$</span>SigHR, <span class="at">decreasing =</span> T), ]</span>
<span id="cb36-18"><a href="tcga-pancanatlas.html#cb36-18" tabindex="-1"></a></span>
<span id="cb36-19"><a href="tcga-pancanatlas.html#cb36-19" tabindex="-1"></a>stat.cohort <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Cohort =</span> <span class="fu">colnames</span>(plot.mat), </span>
<span id="cb36-20"><a href="tcga-pancanatlas.html#cb36-20" tabindex="-1"></a>                          <span class="at">SigCount =</span> <span class="fu">colSums</span>(plot.mat <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">-</span> <span class="fu">colSums</span>(plot.mat <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="cb36-21"><a href="tcga-pancanatlas.html#cb36-21" tabindex="-1"></a>                          <span class="at">SigHR =</span> <span class="fu">colMeans</span>(plot.mat.hr <span class="sc">*</span> <span class="sc">-</span><span class="dv">1</span>) )</span>
<span id="cb36-22"><a href="tcga-pancanatlas.html#cb36-22" tabindex="-1"></a>stat.cohort <span class="ot">&lt;-</span> stat.cohort[<span class="fu">order</span>(stat.cohort<span class="sc">$</span>SigCount, stat.cohort<span class="sc">$</span>SigHR, <span class="at">decreasing =</span> T), ]</span>
<span id="cb36-23"><a href="tcga-pancanatlas.html#cb36-23" tabindex="-1"></a></span>
<span id="cb36-24"><a href="tcga-pancanatlas.html#cb36-24" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">pheatmap</span>(plot.mat[stat.gene<span class="sc">$</span>Gene, stat.cohort<span class="sc">$</span>Cohort], <span class="at">scale =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb36-25"><a href="tcga-pancanatlas.html#cb36-25" tabindex="-1"></a>              <span class="at">color =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;#00599F&quot;</span>,<span class="st">&quot;#EEEEEE&quot;</span>,<span class="st">&quot;#D01910&quot;</span>))(<span class="dv">3</span>),</span>
<span id="cb36-26"><a href="tcga-pancanatlas.html#cb36-26" tabindex="-1"></a>              <span class="at">cluster_row =</span> F, <span class="at">cluster_col =</span> F, <span class="at">border_color =</span> <span class="cn">NA</span>,</span>
<span id="cb36-27"><a href="tcga-pancanatlas.html#cb36-27" tabindex="-1"></a>              <span class="at">fontsize_col =</span> <span class="dv">10</span>,</span>
<span id="cb36-28"><a href="tcga-pancanatlas.html#cb36-28" tabindex="-1"></a>              <span class="at">fontsize_row =</span> <span class="dv">2</span>)</span>
<span id="cb36-29"><a href="tcga-pancanatlas.html#cb36-29" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="p53-compounds_files/figure-html/unnamed-chunk-22-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="wt-up-genes-1" class="section level3 hasAnchor" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> WT-up genes<a href="tcga-pancanatlas.html#wt-up-genes-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>HR of high expression of the 157 WT-up genes among 33 TCGA cancer cohorts. In each cohort, patients are separated by the median value of gene expression, followed by HR values calculation using the univariable Cox regression analysis.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="tcga-pancanatlas.html#cb37-1" tabindex="-1"></a>plot.data <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">&quot;02.tcga/Table6.xlsx&quot;</span>, <span class="at">sheet =</span> <span class="dv">1</span>, <span class="at">startRow =</span> <span class="dv">2</span>)</span>
<span id="cb37-2"><a href="tcga-pancanatlas.html#cb37-2" tabindex="-1"></a></span>
<span id="cb37-3"><a href="tcga-pancanatlas.html#cb37-3" tabindex="-1"></a>plot.data <span class="ot">&lt;-</span> plot.data[, <span class="dv">8</span><span class="sc">:</span><span class="dv">14</span>]</span>
<span id="cb37-4"><a href="tcga-pancanatlas.html#cb37-4" tabindex="-1"></a>plot.data <span class="ot">&lt;-</span> plot.data[<span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(plot.data<span class="sc">$</span>TCGA.Cohort)), ]</span>
<span id="cb37-5"><a href="tcga-pancanatlas.html#cb37-5" tabindex="-1"></a>gene.list <span class="ot">&lt;-</span> <span class="fu">unique</span>(plot.data<span class="sc">$</span><span class="st">`</span><span class="at">WT-up.genes</span><span class="st">`</span>)</span>
<span id="cb37-6"><a href="tcga-pancanatlas.html#cb37-6" tabindex="-1"></a><span class="fu">length</span>(gene.list)</span></code></pre></div>
<pre><code>## [1] 157</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="tcga-pancanatlas.html#cb39-1" tabindex="-1"></a>plot.mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">length</span>(gene.list), <span class="at">ncol =</span> <span class="fu">length</span>(TCGA.ALL))</span>
<span id="cb39-2"><a href="tcga-pancanatlas.html#cb39-2" tabindex="-1"></a><span class="fu">rownames</span>(plot.mat) <span class="ot">&lt;-</span> gene.list</span>
<span id="cb39-3"><a href="tcga-pancanatlas.html#cb39-3" tabindex="-1"></a><span class="fu">colnames</span>(plot.mat) <span class="ot">&lt;-</span> TCGA.ALL</span>
<span id="cb39-4"><a href="tcga-pancanatlas.html#cb39-4" tabindex="-1"></a>plot.mat.hr <span class="ot">&lt;-</span> plot.mat</span>
<span id="cb39-5"><a href="tcga-pancanatlas.html#cb39-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(plot.mat)) {</span>
<span id="cb39-6"><a href="tcga-pancanatlas.html#cb39-6" tabindex="-1"></a>  sub <span class="ot">&lt;-</span> plot.data[<span class="fu">which</span>(plot.data<span class="sc">$</span>TCGA.Cohort <span class="sc">==</span> <span class="fu">colnames</span>(plot.mat)[i]), ]</span>
<span id="cb39-7"><a href="tcga-pancanatlas.html#cb39-7" tabindex="-1"></a>  sub <span class="ot">&lt;-</span> sub[<span class="fu">which</span>(sub<span class="sc">$</span>P.value <span class="sc">&lt;</span> <span class="fl">0.05</span>), ]</span>
<span id="cb39-8"><a href="tcga-pancanatlas.html#cb39-8" tabindex="-1"></a>  plot.mat.hr[<span class="fu">match</span>(sub<span class="sc">$</span><span class="st">`</span><span class="at">WT-up.genes</span><span class="st">`</span>, <span class="fu">rownames</span>(plot.mat.hr)), i] <span class="ot">&lt;-</span> <span class="fu">log2</span>(sub<span class="sc">$</span>HR)</span>
<span id="cb39-9"><a href="tcga-pancanatlas.html#cb39-9" tabindex="-1"></a>  sub<span class="fl">.1</span> <span class="ot">&lt;-</span> sub[<span class="fu">which</span>(sub<span class="sc">$</span>P.value <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> sub<span class="sc">$</span>HR <span class="sc">&gt;</span> <span class="dv">1</span>), ]</span>
<span id="cb39-10"><a href="tcga-pancanatlas.html#cb39-10" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(sub<span class="fl">.1</span>) <span class="sc">&gt;</span> <span class="dv">0</span>) plot.mat[<span class="fu">match</span>(sub<span class="fl">.1</span><span class="sc">$</span><span class="st">`</span><span class="at">WT-up.genes</span><span class="st">`</span>, <span class="fu">rownames</span>(plot.mat)), i] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb39-11"><a href="tcga-pancanatlas.html#cb39-11" tabindex="-1"></a>  sub<span class="fl">.2</span> <span class="ot">&lt;-</span> sub[<span class="fu">which</span>(sub<span class="sc">$</span>P.value <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> sub<span class="sc">$</span>HR <span class="sc">&lt;</span> <span class="dv">1</span>), ]</span>
<span id="cb39-12"><a href="tcga-pancanatlas.html#cb39-12" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(sub<span class="fl">.2</span>) <span class="sc">&gt;</span> <span class="dv">0</span>) plot.mat[<span class="fu">match</span>(sub<span class="fl">.2</span><span class="sc">$</span><span class="st">`</span><span class="at">WT-up.genes</span><span class="st">`</span>, <span class="fu">rownames</span>(plot.mat)), i] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb39-13"><a href="tcga-pancanatlas.html#cb39-13" tabindex="-1"></a>}</span>
<span id="cb39-14"><a href="tcga-pancanatlas.html#cb39-14" tabindex="-1"></a>stat.gene <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Gene =</span> <span class="fu">rownames</span>(plot.mat), </span>
<span id="cb39-15"><a href="tcga-pancanatlas.html#cb39-15" tabindex="-1"></a>                        <span class="at">SigCount =</span> <span class="fu">rowSums</span>(plot.mat <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">-</span> <span class="fu">rowSums</span>(plot.mat <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="cb39-16"><a href="tcga-pancanatlas.html#cb39-16" tabindex="-1"></a>                        <span class="at">SigHR =</span> <span class="fu">rowMeans</span>(plot.mat.hr <span class="sc">*</span> <span class="sc">-</span><span class="dv">1</span>) )</span>
<span id="cb39-17"><a href="tcga-pancanatlas.html#cb39-17" tabindex="-1"></a>stat.gene <span class="ot">&lt;-</span> stat.gene[<span class="fu">order</span>(stat.gene<span class="sc">$</span>SigCount, stat.gene<span class="sc">$</span>SigHR, <span class="at">decreasing =</span> T), ]</span>
<span id="cb39-18"><a href="tcga-pancanatlas.html#cb39-18" tabindex="-1"></a></span>
<span id="cb39-19"><a href="tcga-pancanatlas.html#cb39-19" tabindex="-1"></a>stat.cohort <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Cohort =</span> <span class="fu">colnames</span>(plot.mat), </span>
<span id="cb39-20"><a href="tcga-pancanatlas.html#cb39-20" tabindex="-1"></a>                          <span class="at">SigCount =</span> <span class="fu">colSums</span>(plot.mat <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">-</span> <span class="fu">colSums</span>(plot.mat <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="cb39-21"><a href="tcga-pancanatlas.html#cb39-21" tabindex="-1"></a>                          <span class="at">SigHR =</span> <span class="fu">colMeans</span>(plot.mat.hr <span class="sc">*</span> <span class="sc">-</span><span class="dv">1</span>) )</span>
<span id="cb39-22"><a href="tcga-pancanatlas.html#cb39-22" tabindex="-1"></a>stat.cohort <span class="ot">&lt;-</span> stat.cohort[<span class="fu">order</span>(stat.cohort<span class="sc">$</span>SigCount, stat.cohort<span class="sc">$</span>SigHR, <span class="at">decreasing =</span> T), ]</span>
<span id="cb39-23"><a href="tcga-pancanatlas.html#cb39-23" tabindex="-1"></a></span>
<span id="cb39-24"><a href="tcga-pancanatlas.html#cb39-24" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">pheatmap</span>(plot.mat[stat.gene<span class="sc">$</span>Gene, stat.cohort<span class="sc">$</span>Cohort], <span class="at">scale =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb39-25"><a href="tcga-pancanatlas.html#cb39-25" tabindex="-1"></a>              <span class="at">color =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;#00599F&quot;</span>,<span class="st">&quot;#EEEEEE&quot;</span>,<span class="st">&quot;#D01910&quot;</span>))(<span class="dv">3</span>),</span>
<span id="cb39-26"><a href="tcga-pancanatlas.html#cb39-26" tabindex="-1"></a>              <span class="at">cluster_row =</span> F, <span class="at">cluster_col =</span> F, <span class="at">border_color =</span> <span class="cn">NA</span>,</span>
<span id="cb39-27"><a href="tcga-pancanatlas.html#cb39-27" tabindex="-1"></a>              <span class="at">fontsize_col =</span> <span class="dv">10</span>,</span>
<span id="cb39-28"><a href="tcga-pancanatlas.html#cb39-28" tabindex="-1"></a>              <span class="at">fontsize_row =</span> <span class="dv">2</span>)</span>
<span id="cb39-29"><a href="tcga-pancanatlas.html#cb39-29" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="p53-compounds_files/figure-html/unnamed-chunk-23-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="mut-up-genes-1" class="section level3 hasAnchor" number="6.3.3">
<h3><span class="header-section-number">6.3.3</span> MUT-up genes<a href="tcga-pancanatlas.html#mut-up-genes-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>HR of high expression of the 140 MUT-up genes among 33 TCGA cancer cohorts. In each cohort, patients are separated by the median value of gene expression, followed by HR values calculation using the univariable Cox regression analysis.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="tcga-pancanatlas.html#cb40-1" tabindex="-1"></a>plot.data <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">&quot;02.tcga/Table6.xlsx&quot;</span>, <span class="at">sheet =</span> <span class="dv">1</span>, <span class="at">startRow =</span> <span class="dv">2</span>)</span>
<span id="cb40-2"><a href="tcga-pancanatlas.html#cb40-2" tabindex="-1"></a></span>
<span id="cb40-3"><a href="tcga-pancanatlas.html#cb40-3" tabindex="-1"></a>plot.data <span class="ot">&lt;-</span> plot.data[, <span class="dv">15</span><span class="sc">:</span><span class="dv">21</span>]</span>
<span id="cb40-4"><a href="tcga-pancanatlas.html#cb40-4" tabindex="-1"></a>plot.data <span class="ot">&lt;-</span> plot.data[<span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(plot.data<span class="sc">$</span>TCGA.Cohort)), ]</span>
<span id="cb40-5"><a href="tcga-pancanatlas.html#cb40-5" tabindex="-1"></a>gene.list <span class="ot">&lt;-</span> <span class="fu">unique</span>(plot.data<span class="sc">$</span><span class="st">`</span><span class="at">MUT-up.genes</span><span class="st">`</span>)</span>
<span id="cb40-6"><a href="tcga-pancanatlas.html#cb40-6" tabindex="-1"></a><span class="fu">length</span>(gene.list)</span></code></pre></div>
<pre><code>## [1] 140</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="tcga-pancanatlas.html#cb42-1" tabindex="-1"></a>plot.mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">length</span>(gene.list), <span class="at">ncol =</span> <span class="fu">length</span>(TCGA.ALL))</span>
<span id="cb42-2"><a href="tcga-pancanatlas.html#cb42-2" tabindex="-1"></a><span class="fu">rownames</span>(plot.mat) <span class="ot">&lt;-</span> gene.list</span>
<span id="cb42-3"><a href="tcga-pancanatlas.html#cb42-3" tabindex="-1"></a><span class="fu">colnames</span>(plot.mat) <span class="ot">&lt;-</span> TCGA.ALL</span>
<span id="cb42-4"><a href="tcga-pancanatlas.html#cb42-4" tabindex="-1"></a>plot.mat.hr <span class="ot">&lt;-</span> plot.mat</span>
<span id="cb42-5"><a href="tcga-pancanatlas.html#cb42-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(plot.mat)) {</span>
<span id="cb42-6"><a href="tcga-pancanatlas.html#cb42-6" tabindex="-1"></a>  sub <span class="ot">&lt;-</span> plot.data[<span class="fu">which</span>(plot.data<span class="sc">$</span>TCGA.Cohort <span class="sc">==</span> <span class="fu">colnames</span>(plot.mat)[i]), ]</span>
<span id="cb42-7"><a href="tcga-pancanatlas.html#cb42-7" tabindex="-1"></a>  sub <span class="ot">&lt;-</span> sub[<span class="fu">which</span>(sub<span class="sc">$</span>P.value <span class="sc">&lt;</span> <span class="fl">0.05</span>), ]</span>
<span id="cb42-8"><a href="tcga-pancanatlas.html#cb42-8" tabindex="-1"></a>  plot.mat.hr[<span class="fu">match</span>(sub<span class="sc">$</span><span class="st">`</span><span class="at">MUT-up.genes</span><span class="st">`</span>, <span class="fu">rownames</span>(plot.mat.hr)), i] <span class="ot">&lt;-</span> <span class="fu">log2</span>(sub<span class="sc">$</span>HR)</span>
<span id="cb42-9"><a href="tcga-pancanatlas.html#cb42-9" tabindex="-1"></a>  sub<span class="fl">.1</span> <span class="ot">&lt;-</span> sub[<span class="fu">which</span>(sub<span class="sc">$</span>P.value <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> sub<span class="sc">$</span>HR <span class="sc">&gt;</span> <span class="dv">1</span>), ]</span>
<span id="cb42-10"><a href="tcga-pancanatlas.html#cb42-10" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(sub<span class="fl">.1</span>) <span class="sc">&gt;</span> <span class="dv">0</span>) plot.mat[<span class="fu">match</span>(sub<span class="fl">.1</span><span class="sc">$</span><span class="st">`</span><span class="at">MUT-up.genes</span><span class="st">`</span>, <span class="fu">rownames</span>(plot.mat)), i] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb42-11"><a href="tcga-pancanatlas.html#cb42-11" tabindex="-1"></a>  sub<span class="fl">.2</span> <span class="ot">&lt;-</span> sub[<span class="fu">which</span>(sub<span class="sc">$</span>P.value <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> sub<span class="sc">$</span>HR <span class="sc">&lt;</span> <span class="dv">1</span>), ]</span>
<span id="cb42-12"><a href="tcga-pancanatlas.html#cb42-12" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(sub<span class="fl">.2</span>) <span class="sc">&gt;</span> <span class="dv">0</span>) plot.mat[<span class="fu">match</span>(sub<span class="fl">.2</span><span class="sc">$</span><span class="st">`</span><span class="at">MUT-up.genes</span><span class="st">`</span>, <span class="fu">rownames</span>(plot.mat)), i] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb42-13"><a href="tcga-pancanatlas.html#cb42-13" tabindex="-1"></a>}</span>
<span id="cb42-14"><a href="tcga-pancanatlas.html#cb42-14" tabindex="-1"></a>stat.gene <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Gene =</span> <span class="fu">rownames</span>(plot.mat), </span>
<span id="cb42-15"><a href="tcga-pancanatlas.html#cb42-15" tabindex="-1"></a>                        <span class="at">SigCount =</span> <span class="fu">rowSums</span>(plot.mat <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">-</span> <span class="fu">rowSums</span>(plot.mat <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb42-16"><a href="tcga-pancanatlas.html#cb42-16" tabindex="-1"></a>                        <span class="at">SigHR =</span> <span class="fu">rowMeans</span>(plot.mat.hr <span class="sc">*</span> <span class="dv">1</span>) )</span>
<span id="cb42-17"><a href="tcga-pancanatlas.html#cb42-17" tabindex="-1"></a>stat.gene <span class="ot">&lt;-</span> stat.gene[<span class="fu">order</span>(stat.gene<span class="sc">$</span>SigCount, stat.gene<span class="sc">$</span>SigHR, <span class="at">decreasing =</span> T), ]</span>
<span id="cb42-18"><a href="tcga-pancanatlas.html#cb42-18" tabindex="-1"></a></span>
<span id="cb42-19"><a href="tcga-pancanatlas.html#cb42-19" tabindex="-1"></a>stat.cohort <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Cohort =</span> <span class="fu">colnames</span>(plot.mat), </span>
<span id="cb42-20"><a href="tcga-pancanatlas.html#cb42-20" tabindex="-1"></a>                          <span class="at">SigCount =</span> <span class="fu">colSums</span>(plot.mat <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">-</span> <span class="fu">colSums</span>(plot.mat <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb42-21"><a href="tcga-pancanatlas.html#cb42-21" tabindex="-1"></a>                          <span class="at">SigHR =</span> <span class="fu">colMeans</span>(plot.mat.hr <span class="sc">*</span> <span class="dv">1</span>) )</span>
<span id="cb42-22"><a href="tcga-pancanatlas.html#cb42-22" tabindex="-1"></a>stat.cohort <span class="ot">&lt;-</span> stat.cohort[<span class="fu">order</span>(stat.cohort<span class="sc">$</span>SigCount, stat.cohort<span class="sc">$</span>SigHR, <span class="at">decreasing =</span> T), ]</span>
<span id="cb42-23"><a href="tcga-pancanatlas.html#cb42-23" tabindex="-1"></a></span>
<span id="cb42-24"><a href="tcga-pancanatlas.html#cb42-24" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">pheatmap</span>(plot.mat[stat.gene<span class="sc">$</span>Gene, stat.cohort<span class="sc">$</span>Cohort], <span class="at">scale =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb42-25"><a href="tcga-pancanatlas.html#cb42-25" tabindex="-1"></a>              <span class="at">color =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;#00599F&quot;</span>,<span class="st">&quot;#EEEEEE&quot;</span>,<span class="st">&quot;#D01910&quot;</span>))(<span class="dv">3</span>),</span>
<span id="cb42-26"><a href="tcga-pancanatlas.html#cb42-26" tabindex="-1"></a>              <span class="at">cluster_row =</span> F, <span class="at">cluster_col =</span> F, <span class="at">border_color =</span> <span class="cn">NA</span>,</span>
<span id="cb42-27"><a href="tcga-pancanatlas.html#cb42-27" tabindex="-1"></a>              <span class="at">fontsize_col =</span> <span class="dv">10</span>,</span>
<span id="cb42-28"><a href="tcga-pancanatlas.html#cb42-28" tabindex="-1"></a>              <span class="at">fontsize_row =</span> <span class="dv">2</span>)</span>
<span id="cb42-29"><a href="tcga-pancanatlas.html#cb42-29" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="p53-compounds_files/figure-html/unnamed-chunk-24-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="powerfulness-in-regulating" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Powerfulness in regulating<a href="tcga-pancanatlas.html#powerfulness-in-regulating" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Heatmap of fold changes of expression of the p53 signature genes between p53-wild-type and p53-mutant tumors in the TCGA Pan-Cancer Atlas.</p>
<div id="p53-targets-2" class="section level3 hasAnchor" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> 116 p53 targets<a href="tcga-pancanatlas.html#p53-targets-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Heatmap of fold changes of expression of the 116 reported p53 target genes between samples with wild-type p53 and samples with frequent mutant p53 (&gt; 0.5% mutation frequency). Note the p53 mutants with &gt; 0.5% mutation frequency are the ones most likely losing wild-type functions.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="tcga-pancanatlas.html#cb43-1" tabindex="-1"></a>TCGA.ALL <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;TCGA-OV&quot;</span>,<span class="st">&quot;TCGA-UCS&quot;</span>,<span class="st">&quot;TCGA-LUSC&quot;</span>,<span class="st">&quot;TCGA-ESCA&quot;</span>,<span class="st">&quot;TCGA-READ&quot;</span>,<span class="st">&quot;TCGA-HNSC&quot;</span>,<span class="st">&quot;TCGA-PAAD&quot;</span>,<span class="st">&quot;TCGA-COAD&quot;</span>,<span class="st">&quot;TCGA-LUAD&quot;</span>,<span class="st">&quot;TCGA-BLCA&quot;</span>,<span class="st">&quot;TCGA-STAD&quot;</span>,<span class="st">&quot;TCGA-LGG&quot;</span>,<span class="st">&quot;TCGA-UCEC&quot;</span>,<span class="st">&quot;TCGA-SARC&quot;</span>,<span class="st">&quot;TCGA-BRCA&quot;</span>,<span class="st">&quot;TCGA-GBM&quot;</span>,<span class="st">&quot;TCGA-LIHC&quot;</span>,<span class="st">&quot;TCGA-KICH&quot;</span>,<span class="st">&quot;TCGA-ACC&quot;</span>,<span class="st">&quot;TCGA-MESO&quot;</span>,<span class="st">&quot;TCGA-DLBC&quot;</span>,<span class="st">&quot;TCGA-PRAD&quot;</span>,<span class="st">&quot;TCGA-CHOL&quot;</span>,<span class="st">&quot;TCGA-SKCM&quot;</span>,<span class="st">&quot;TCGA-CESC&quot;</span>,<span class="st">&quot;TCGA-LAML&quot;</span>,<span class="st">&quot;TCGA-THYM&quot;</span>,<span class="st">&quot;TCGA-KIRC&quot;</span>,<span class="st">&quot;TCGA-KIRP&quot;</span>,<span class="st">&quot;TCGA-TGCT&quot;</span>,<span class="st">&quot;TCGA-THCA&quot;</span>,<span class="st">&quot;TCGA-PCPG&quot;</span>,<span class="st">&quot;TCGA-UVM&quot;</span>)</span>
<span id="cb43-2"><a href="tcga-pancanatlas.html#cb43-2" tabindex="-1"></a></span>
<span id="cb43-3"><a href="tcga-pancanatlas.html#cb43-3" tabindex="-1"></a>plot.data <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">&quot;02.tcga/Table7.xlsx&quot;</span>, <span class="at">sheet =</span> <span class="dv">1</span>, <span class="at">startRow =</span> <span class="dv">2</span>)</span>
<span id="cb43-4"><a href="tcga-pancanatlas.html#cb43-4" tabindex="-1"></a></span>
<span id="cb43-5"><a href="tcga-pancanatlas.html#cb43-5" tabindex="-1"></a>plot.data <span class="ot">&lt;-</span> plot.data[, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb43-6"><a href="tcga-pancanatlas.html#cb43-6" tabindex="-1"></a>plot.data <span class="ot">&lt;-</span> plot.data[<span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(plot.data<span class="sc">$</span>TCGA.Cohort)), ]</span>
<span id="cb43-7"><a href="tcga-pancanatlas.html#cb43-7" tabindex="-1"></a>gene.list <span class="ot">&lt;-</span> <span class="fu">unique</span>(plot.data<span class="sc">$</span>p53.targets)</span>
<span id="cb43-8"><a href="tcga-pancanatlas.html#cb43-8" tabindex="-1"></a><span class="fu">length</span>(gene.list)</span></code></pre></div>
<pre><code>## [1] 116</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="tcga-pancanatlas.html#cb45-1" tabindex="-1"></a>plot.mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(gene.list), <span class="at">ncol =</span> <span class="fu">length</span>(TCGA.ALL))</span>
<span id="cb45-2"><a href="tcga-pancanatlas.html#cb45-2" tabindex="-1"></a><span class="fu">rownames</span>(plot.mat) <span class="ot">&lt;-</span> gene.list</span>
<span id="cb45-3"><a href="tcga-pancanatlas.html#cb45-3" tabindex="-1"></a><span class="fu">colnames</span>(plot.mat) <span class="ot">&lt;-</span> TCGA.ALL</span>
<span id="cb45-4"><a href="tcga-pancanatlas.html#cb45-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(plot.mat)) {</span>
<span id="cb45-5"><a href="tcga-pancanatlas.html#cb45-5" tabindex="-1"></a>  sub <span class="ot">&lt;-</span> plot.data[<span class="fu">which</span>(plot.data<span class="sc">$</span>TCGA.Cohort <span class="sc">==</span> <span class="fu">colnames</span>(plot.mat)[i]), ]</span>
<span id="cb45-6"><a href="tcga-pancanatlas.html#cb45-6" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(sub) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb45-7"><a href="tcga-pancanatlas.html#cb45-7" tabindex="-1"></a>    plot.mat[, i] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb45-8"><a href="tcga-pancanatlas.html#cb45-8" tabindex="-1"></a>    sub<span class="fl">.1</span> <span class="ot">&lt;-</span> sub[<span class="fu">which</span>(sub<span class="sc">$</span>log2FC <span class="sc">&gt;</span> <span class="dv">0</span>), ]</span>
<span id="cb45-9"><a href="tcga-pancanatlas.html#cb45-9" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(sub<span class="fl">.1</span>) <span class="sc">&gt;</span> <span class="dv">0</span>) plot.mat[sub<span class="fl">.1</span><span class="sc">$</span>p53.targets, i] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb45-10"><a href="tcga-pancanatlas.html#cb45-10" tabindex="-1"></a>    sub<span class="fl">.2</span> <span class="ot">&lt;-</span> sub[<span class="fu">which</span>(sub<span class="sc">$</span>log2FC <span class="sc">&gt;</span> <span class="fl">0.58</span> <span class="sc">&amp;</span> sub<span class="sc">$</span>adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.05</span>), ]</span>
<span id="cb45-11"><a href="tcga-pancanatlas.html#cb45-11" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(sub<span class="fl">.2</span>) <span class="sc">&gt;</span> <span class="dv">0</span>) plot.mat[sub<span class="fl">.2</span><span class="sc">$</span>p53.targets, i] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb45-12"><a href="tcga-pancanatlas.html#cb45-12" tabindex="-1"></a>  }</span>
<span id="cb45-13"><a href="tcga-pancanatlas.html#cb45-13" tabindex="-1"></a>}</span>
<span id="cb45-14"><a href="tcga-pancanatlas.html#cb45-14" tabindex="-1"></a>stat.cohort <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Cohort =</span> <span class="fu">colnames</span>(plot.mat), </span>
<span id="cb45-15"><a href="tcga-pancanatlas.html#cb45-15" tabindex="-1"></a>                          <span class="at">SigCount =</span> <span class="fu">colSums</span>(plot.mat <span class="sc">==</span> <span class="dv">2</span>),</span>
<span id="cb45-16"><a href="tcga-pancanatlas.html#cb45-16" tabindex="-1"></a>                          <span class="at">NotSigCount =</span> <span class="fu">colSums</span>(plot.mat <span class="sc">==</span> <span class="dv">1</span>) )</span>
<span id="cb45-17"><a href="tcga-pancanatlas.html#cb45-17" tabindex="-1"></a>stat.cohort <span class="ot">&lt;-</span> stat.cohort[<span class="fu">order</span>(stat.cohort<span class="sc">$</span>SigCount, stat.cohort<span class="sc">$</span>NotSigCount, <span class="at">decreasing =</span> T), ]</span>
<span id="cb45-18"><a href="tcga-pancanatlas.html#cb45-18" tabindex="-1"></a></span>
<span id="cb45-19"><a href="tcga-pancanatlas.html#cb45-19" tabindex="-1"></a>plot.mat <span class="ot">&lt;-</span> plot.mat[, stat.cohort<span class="sc">$</span>Cohort]</span>
<span id="cb45-20"><a href="tcga-pancanatlas.html#cb45-20" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">pheatmap</span>(plot.mat, <span class="at">scale =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb45-21"><a href="tcga-pancanatlas.html#cb45-21" tabindex="-1"></a>              <span class="at">color =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;#fffef3&quot;</span>,<span class="st">&quot;#edd1ff&quot;</span>,<span class="st">&quot;#984ac9&quot;</span>))(<span class="dv">501</span>),</span>
<span id="cb45-22"><a href="tcga-pancanatlas.html#cb45-22" tabindex="-1"></a>              <span class="at">cluster_row =</span> F, <span class="at">cluster_col =</span> F, <span class="at">border_color =</span> <span class="cn">NA</span>,</span>
<span id="cb45-23"><a href="tcga-pancanatlas.html#cb45-23" tabindex="-1"></a>              <span class="at">clustering_method =</span> <span class="st">&quot;ward.D2&quot;</span>,</span>
<span id="cb45-24"><a href="tcga-pancanatlas.html#cb45-24" tabindex="-1"></a>              <span class="at">display_numbers =</span> <span class="cn">FALSE</span>,</span>
<span id="cb45-25"><a href="tcga-pancanatlas.html#cb45-25" tabindex="-1"></a>              <span class="at">number_format =</span> <span class="st">&quot;%.f&quot;</span>, <span class="at">number_color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb45-26"><a href="tcga-pancanatlas.html#cb45-26" tabindex="-1"></a>              <span class="at">clustering_distance_rows =</span> <span class="st">&quot;manhattan&quot;</span>,</span>
<span id="cb45-27"><a href="tcga-pancanatlas.html#cb45-27" tabindex="-1"></a>              <span class="at">clustering_distance_cols =</span> <span class="st">&quot;manhattan&quot;</span>,</span>
<span id="cb45-28"><a href="tcga-pancanatlas.html#cb45-28" tabindex="-1"></a>              <span class="at">fontsize_col =</span> <span class="dv">10</span>,</span>
<span id="cb45-29"><a href="tcga-pancanatlas.html#cb45-29" tabindex="-1"></a>              <span class="at">fontsize_row =</span> <span class="dv">1</span>)</span>
<span id="cb45-30"><a href="tcga-pancanatlas.html#cb45-30" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="p53-compounds_files/figure-html/unnamed-chunk-25-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="wt-up-genes-2" class="section level3 hasAnchor" number="6.4.2">
<h3><span class="header-section-number">6.4.2</span> WT-up genes<a href="tcga-pancanatlas.html#wt-up-genes-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Heatmap of fold changes of expression of the 157 WT-up genes between samples with wild-type p53 and samples with frequent mutant p53 (&gt; 0.5% mutation frequency). Note the p53 mutants with &gt; 0.5% mutation frequency are the ones most likely losing wild-type functions.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="tcga-pancanatlas.html#cb46-1" tabindex="-1"></a>plot.data <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">&quot;02.tcga/Table7.xlsx&quot;</span>, <span class="at">sheet =</span> <span class="dv">1</span>, <span class="at">startRow =</span> <span class="dv">2</span>)</span>
<span id="cb46-2"><a href="tcga-pancanatlas.html#cb46-2" tabindex="-1"></a></span>
<span id="cb46-3"><a href="tcga-pancanatlas.html#cb46-3" tabindex="-1"></a>plot.data <span class="ot">&lt;-</span> plot.data[, <span class="dv">7</span><span class="sc">:</span><span class="dv">12</span>]</span>
<span id="cb46-4"><a href="tcga-pancanatlas.html#cb46-4" tabindex="-1"></a>plot.data <span class="ot">&lt;-</span> plot.data[<span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(plot.data<span class="sc">$</span>TCGA.Cohort)), ]</span>
<span id="cb46-5"><a href="tcga-pancanatlas.html#cb46-5" tabindex="-1"></a>gene.list <span class="ot">&lt;-</span> <span class="fu">unique</span>(plot.data<span class="sc">$</span><span class="st">`</span><span class="at">WT-up.genes</span><span class="st">`</span>)</span>
<span id="cb46-6"><a href="tcga-pancanatlas.html#cb46-6" tabindex="-1"></a><span class="fu">length</span>(gene.list)</span></code></pre></div>
<pre><code>## [1] 157</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="tcga-pancanatlas.html#cb48-1" tabindex="-1"></a>plot.mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(gene.list), <span class="at">ncol =</span> <span class="fu">length</span>(TCGA.ALL))</span>
<span id="cb48-2"><a href="tcga-pancanatlas.html#cb48-2" tabindex="-1"></a><span class="fu">rownames</span>(plot.mat) <span class="ot">&lt;-</span> gene.list</span>
<span id="cb48-3"><a href="tcga-pancanatlas.html#cb48-3" tabindex="-1"></a><span class="fu">colnames</span>(plot.mat) <span class="ot">&lt;-</span> TCGA.ALL</span>
<span id="cb48-4"><a href="tcga-pancanatlas.html#cb48-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(plot.mat)) {</span>
<span id="cb48-5"><a href="tcga-pancanatlas.html#cb48-5" tabindex="-1"></a>  sub <span class="ot">&lt;-</span> plot.data[<span class="fu">which</span>(plot.data<span class="sc">$</span>TCGA.Cohort <span class="sc">==</span> <span class="fu">colnames</span>(plot.mat)[i]), ]</span>
<span id="cb48-6"><a href="tcga-pancanatlas.html#cb48-6" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(sub) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb48-7"><a href="tcga-pancanatlas.html#cb48-7" tabindex="-1"></a>    plot.mat[, i] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb48-8"><a href="tcga-pancanatlas.html#cb48-8" tabindex="-1"></a>    sub<span class="fl">.1</span> <span class="ot">&lt;-</span> sub[<span class="fu">which</span>(sub<span class="sc">$</span>log2FC <span class="sc">&gt;</span> <span class="dv">0</span>), ]</span>
<span id="cb48-9"><a href="tcga-pancanatlas.html#cb48-9" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(sub<span class="fl">.1</span>) <span class="sc">&gt;</span> <span class="dv">0</span>) plot.mat[sub<span class="fl">.1</span><span class="sc">$</span><span class="st">`</span><span class="at">WT-up.genes</span><span class="st">`</span>, i] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb48-10"><a href="tcga-pancanatlas.html#cb48-10" tabindex="-1"></a>    sub<span class="fl">.2</span> <span class="ot">&lt;-</span> sub[<span class="fu">which</span>(sub<span class="sc">$</span>log2FC <span class="sc">&gt;</span> <span class="fl">0.58</span> <span class="sc">&amp;</span> sub<span class="sc">$</span>adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.05</span>), ]</span>
<span id="cb48-11"><a href="tcga-pancanatlas.html#cb48-11" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(sub<span class="fl">.2</span>) <span class="sc">&gt;</span> <span class="dv">0</span>) plot.mat[sub<span class="fl">.2</span><span class="sc">$</span><span class="st">`</span><span class="at">WT-up.genes</span><span class="st">`</span>, i] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb48-12"><a href="tcga-pancanatlas.html#cb48-12" tabindex="-1"></a>  }</span>
<span id="cb48-13"><a href="tcga-pancanatlas.html#cb48-13" tabindex="-1"></a>}</span>
<span id="cb48-14"><a href="tcga-pancanatlas.html#cb48-14" tabindex="-1"></a>stat.cohort <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Cohort =</span> <span class="fu">colnames</span>(plot.mat), </span>
<span id="cb48-15"><a href="tcga-pancanatlas.html#cb48-15" tabindex="-1"></a>                          <span class="at">SigCount =</span> <span class="fu">colSums</span>(plot.mat <span class="sc">==</span> <span class="dv">2</span>),</span>
<span id="cb48-16"><a href="tcga-pancanatlas.html#cb48-16" tabindex="-1"></a>                          <span class="at">NotSigCount =</span> <span class="fu">colSums</span>(plot.mat <span class="sc">==</span> <span class="dv">1</span>) )</span>
<span id="cb48-17"><a href="tcga-pancanatlas.html#cb48-17" tabindex="-1"></a>stat.cohort <span class="ot">&lt;-</span> stat.cohort[<span class="fu">order</span>(stat.cohort<span class="sc">$</span>SigCount, stat.cohort<span class="sc">$</span>NotSigCount, <span class="at">decreasing =</span> T), ]</span>
<span id="cb48-18"><a href="tcga-pancanatlas.html#cb48-18" tabindex="-1"></a></span>
<span id="cb48-19"><a href="tcga-pancanatlas.html#cb48-19" tabindex="-1"></a>plot.mat <span class="ot">&lt;-</span> plot.mat[, stat.cohort<span class="sc">$</span>Cohort]</span>
<span id="cb48-20"><a href="tcga-pancanatlas.html#cb48-20" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">pheatmap</span>(plot.mat, <span class="at">scale =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb48-21"><a href="tcga-pancanatlas.html#cb48-21" tabindex="-1"></a>              <span class="at">color =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;#fffef3&quot;</span>,<span class="st">&quot;#edd1ff&quot;</span>,<span class="st">&quot;#984ac9&quot;</span>))(<span class="dv">501</span>),</span>
<span id="cb48-22"><a href="tcga-pancanatlas.html#cb48-22" tabindex="-1"></a>              <span class="at">cluster_row =</span> F, <span class="at">cluster_col =</span> F, <span class="at">border_color =</span> <span class="cn">NA</span>,</span>
<span id="cb48-23"><a href="tcga-pancanatlas.html#cb48-23" tabindex="-1"></a>              <span class="at">clustering_method =</span> <span class="st">&quot;ward.D2&quot;</span>,</span>
<span id="cb48-24"><a href="tcga-pancanatlas.html#cb48-24" tabindex="-1"></a>              <span class="at">display_numbers =</span> <span class="cn">FALSE</span>,</span>
<span id="cb48-25"><a href="tcga-pancanatlas.html#cb48-25" tabindex="-1"></a>              <span class="at">number_format =</span> <span class="st">&quot;%.f&quot;</span>, <span class="at">number_color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb48-26"><a href="tcga-pancanatlas.html#cb48-26" tabindex="-1"></a>              <span class="at">clustering_distance_rows =</span> <span class="st">&quot;manhattan&quot;</span>,</span>
<span id="cb48-27"><a href="tcga-pancanatlas.html#cb48-27" tabindex="-1"></a>              <span class="at">clustering_distance_cols =</span> <span class="st">&quot;manhattan&quot;</span>,</span>
<span id="cb48-28"><a href="tcga-pancanatlas.html#cb48-28" tabindex="-1"></a>              <span class="at">fontsize_col =</span> <span class="dv">10</span>,</span>
<span id="cb48-29"><a href="tcga-pancanatlas.html#cb48-29" tabindex="-1"></a>              <span class="at">fontsize_row =</span> <span class="dv">1</span>)</span>
<span id="cb48-30"><a href="tcga-pancanatlas.html#cb48-30" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="p53-compounds_files/figure-html/unnamed-chunk-26-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="mut-up-genes-2" class="section level3 hasAnchor" number="6.4.3">
<h3><span class="header-section-number">6.4.3</span> MUT-up genes<a href="tcga-pancanatlas.html#mut-up-genes-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Heatmap of fold changes of expression of the 140 MUT-up genes between samples with frequent missense mutant p53 (&gt; 0.5% mutation frequency) and samples with wild-type p53. Note the frequent missense mutant p53 with &gt; 0.5% mutation frequency are the ones most likely possessing of GOF.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="tcga-pancanatlas.html#cb49-1" tabindex="-1"></a>plot.data <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">&quot;02.tcga/Table7.xlsx&quot;</span>, <span class="at">sheet =</span> <span class="dv">1</span>, <span class="at">startRow =</span> <span class="dv">2</span>)</span>
<span id="cb49-2"><a href="tcga-pancanatlas.html#cb49-2" tabindex="-1"></a></span>
<span id="cb49-3"><a href="tcga-pancanatlas.html#cb49-3" tabindex="-1"></a>plot.data <span class="ot">&lt;-</span> plot.data[, <span class="dv">13</span><span class="sc">:</span><span class="dv">18</span>]</span>
<span id="cb49-4"><a href="tcga-pancanatlas.html#cb49-4" tabindex="-1"></a>plot.data <span class="ot">&lt;-</span> plot.data[<span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(plot.data<span class="sc">$</span>TCGA.Cohort)), ]</span>
<span id="cb49-5"><a href="tcga-pancanatlas.html#cb49-5" tabindex="-1"></a>gene.list <span class="ot">&lt;-</span> <span class="fu">unique</span>(plot.data<span class="sc">$</span><span class="st">`</span><span class="at">MUT-up.genes</span><span class="st">`</span>)</span>
<span id="cb49-6"><a href="tcga-pancanatlas.html#cb49-6" tabindex="-1"></a><span class="fu">length</span>(gene.list)</span></code></pre></div>
<pre><code>## [1] 140</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="tcga-pancanatlas.html#cb51-1" tabindex="-1"></a>plot.mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(gene.list), <span class="at">ncol =</span> <span class="fu">length</span>(TCGA.ALL))</span>
<span id="cb51-2"><a href="tcga-pancanatlas.html#cb51-2" tabindex="-1"></a><span class="fu">rownames</span>(plot.mat) <span class="ot">&lt;-</span> gene.list</span>
<span id="cb51-3"><a href="tcga-pancanatlas.html#cb51-3" tabindex="-1"></a><span class="fu">colnames</span>(plot.mat) <span class="ot">&lt;-</span> TCGA.ALL</span>
<span id="cb51-4"><a href="tcga-pancanatlas.html#cb51-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(plot.mat)) {</span>
<span id="cb51-5"><a href="tcga-pancanatlas.html#cb51-5" tabindex="-1"></a>  sub <span class="ot">&lt;-</span> plot.data[<span class="fu">which</span>(plot.data<span class="sc">$</span>TCGA.Cohort <span class="sc">==</span> <span class="fu">colnames</span>(plot.mat)[i]), ]</span>
<span id="cb51-6"><a href="tcga-pancanatlas.html#cb51-6" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(sub) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb51-7"><a href="tcga-pancanatlas.html#cb51-7" tabindex="-1"></a>    plot.mat[, i] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb51-8"><a href="tcga-pancanatlas.html#cb51-8" tabindex="-1"></a>    sub<span class="fl">.1</span> <span class="ot">&lt;-</span> sub[<span class="fu">which</span>(sub<span class="sc">$</span>log2FC <span class="sc">&gt;</span> <span class="dv">0</span>), ]</span>
<span id="cb51-9"><a href="tcga-pancanatlas.html#cb51-9" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(sub<span class="fl">.1</span>) <span class="sc">&gt;</span> <span class="dv">0</span>) plot.mat[sub<span class="fl">.1</span><span class="sc">$</span><span class="st">`</span><span class="at">MUT-up.genes</span><span class="st">`</span>, i] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb51-10"><a href="tcga-pancanatlas.html#cb51-10" tabindex="-1"></a>    sub<span class="fl">.2</span> <span class="ot">&lt;-</span> sub[<span class="fu">which</span>(sub<span class="sc">$</span>log2FC <span class="sc">&gt;</span> <span class="fl">0.58</span> <span class="sc">&amp;</span> sub<span class="sc">$</span>adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.05</span>), ]</span>
<span id="cb51-11"><a href="tcga-pancanatlas.html#cb51-11" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(sub<span class="fl">.2</span>) <span class="sc">&gt;</span> <span class="dv">0</span>) plot.mat[sub<span class="fl">.2</span><span class="sc">$</span><span class="st">`</span><span class="at">MUT-up.genes</span><span class="st">`</span>, i] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb51-12"><a href="tcga-pancanatlas.html#cb51-12" tabindex="-1"></a>  }</span>
<span id="cb51-13"><a href="tcga-pancanatlas.html#cb51-13" tabindex="-1"></a>}</span>
<span id="cb51-14"><a href="tcga-pancanatlas.html#cb51-14" tabindex="-1"></a>stat.cohort <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Cohort =</span> <span class="fu">colnames</span>(plot.mat), </span>
<span id="cb51-15"><a href="tcga-pancanatlas.html#cb51-15" tabindex="-1"></a>                          <span class="at">SigCount =</span> <span class="fu">colSums</span>(plot.mat <span class="sc">==</span> <span class="dv">2</span>),</span>
<span id="cb51-16"><a href="tcga-pancanatlas.html#cb51-16" tabindex="-1"></a>                          <span class="at">NotSigCount =</span> <span class="fu">colSums</span>(plot.mat <span class="sc">==</span> <span class="dv">1</span>) )</span>
<span id="cb51-17"><a href="tcga-pancanatlas.html#cb51-17" tabindex="-1"></a>stat.cohort <span class="ot">&lt;-</span> stat.cohort[<span class="fu">order</span>(stat.cohort<span class="sc">$</span>SigCount, stat.cohort<span class="sc">$</span>NotSigCount, <span class="at">decreasing =</span> T), ]</span>
<span id="cb51-18"><a href="tcga-pancanatlas.html#cb51-18" tabindex="-1"></a></span>
<span id="cb51-19"><a href="tcga-pancanatlas.html#cb51-19" tabindex="-1"></a>plot.mat <span class="ot">&lt;-</span> plot.mat[, stat.cohort<span class="sc">$</span>Cohort]</span>
<span id="cb51-20"><a href="tcga-pancanatlas.html#cb51-20" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">pheatmap</span>(plot.mat, <span class="at">scale =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb51-21"><a href="tcga-pancanatlas.html#cb51-21" tabindex="-1"></a>              <span class="at">color =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;#fffef3&quot;</span>,<span class="st">&quot;#edd1ff&quot;</span>,<span class="st">&quot;#984ac9&quot;</span>))(<span class="dv">501</span>),</span>
<span id="cb51-22"><a href="tcga-pancanatlas.html#cb51-22" tabindex="-1"></a>              <span class="at">cluster_row =</span> F, <span class="at">cluster_col =</span> F, <span class="at">border_color =</span> <span class="cn">NA</span>,</span>
<span id="cb51-23"><a href="tcga-pancanatlas.html#cb51-23" tabindex="-1"></a>              <span class="at">clustering_method =</span> <span class="st">&quot;ward.D2&quot;</span>,</span>
<span id="cb51-24"><a href="tcga-pancanatlas.html#cb51-24" tabindex="-1"></a>              <span class="at">display_numbers =</span> <span class="cn">FALSE</span>,</span>
<span id="cb51-25"><a href="tcga-pancanatlas.html#cb51-25" tabindex="-1"></a>              <span class="at">number_format =</span> <span class="st">&quot;%.f&quot;</span>, <span class="at">number_color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb51-26"><a href="tcga-pancanatlas.html#cb51-26" tabindex="-1"></a>              <span class="at">clustering_distance_rows =</span> <span class="st">&quot;manhattan&quot;</span>,</span>
<span id="cb51-27"><a href="tcga-pancanatlas.html#cb51-27" tabindex="-1"></a>              <span class="at">clustering_distance_cols =</span> <span class="st">&quot;manhattan&quot;</span>,</span>
<span id="cb51-28"><a href="tcga-pancanatlas.html#cb51-28" tabindex="-1"></a>              <span class="at">fontsize_col =</span> <span class="dv">10</span>,</span>
<span id="cb51-29"><a href="tcga-pancanatlas.html#cb51-29" tabindex="-1"></a>              <span class="at">fontsize_row =</span> <span class="dv">1</span>)</span>
<span id="cb51-30"><a href="tcga-pancanatlas.html#cb51-30" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="p53-compounds_files/figure-html/unnamed-chunk-27-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="hr-for-p53-mutations" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> HR for p53 mutations<a href="tcga-pancanatlas.html#hr-for-p53-mutations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>HR for p53 mutations in 33 TCGA cancer types.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="tcga-pancanatlas.html#cb52-1" tabindex="-1"></a>tcga.meta <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">&quot;02.tcga/Table5.xlsx&quot;</span>, <span class="at">sheet =</span> <span class="dv">1</span>, <span class="at">startRow =</span> <span class="dv">2</span>)</span>
<span id="cb52-2"><a href="tcga-pancanatlas.html#cb52-2" tabindex="-1"></a></span>
<span id="cb52-3"><a href="tcga-pancanatlas.html#cb52-3" tabindex="-1"></a>plot.data <span class="ot">&lt;-</span> tcga.meta[, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span>
<span id="cb52-4"><a href="tcga-pancanatlas.html#cb52-4" tabindex="-1"></a>plot.data <span class="ot">&lt;-</span> plot.data[<span class="fu">which</span>(plot.data<span class="sc">$</span>With.survival.data <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> plot.data<span class="sc">$</span>Sample.type <span class="sc">==</span> <span class="st">&quot;Primary Tumor&quot;</span> <span class="sc">&amp;</span> plot.data<span class="sc">$</span>MutationReported <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>), ]</span>
<span id="cb52-5"><a href="tcga-pancanatlas.html#cb52-5" tabindex="-1"></a><span class="fu">table</span>(plot.data<span class="sc">$</span>TCGA.cohort[<span class="fu">which</span>(plot.data<span class="sc">$</span>p53mut <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>)]) <span class="sc">%&gt;%</span> <span class="fu">sort</span>(<span class="at">decreasing =</span> T)</span></code></pre></div>
<pre><code>## integer(0)</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="tcga-pancanatlas.html#cb54-1" tabindex="-1"></a><span class="co"># select p53 mutated samples &gt; 5</span></span>
<span id="cb54-2"><a href="tcga-pancanatlas.html#cb54-2" tabindex="-1"></a>TCGA.OS <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;TCGA-KICH&quot;</span>,<span class="st">&quot;TCGA-KIRC&quot;</span>,<span class="st">&quot;TCGA-ACC&quot;</span>,<span class="st">&quot;TCGA-LAML&quot;</span>,<span class="st">&quot;TCGA-UCEC&quot;</span>,<span class="st">&quot;TCGA-PAAD&quot;</span>,<span class="st">&quot;TCGA-LIHC&quot;</span>,<span class="st">&quot;TCGA-BRCA&quot;</span>,<span class="st">&quot;TCGA-HNSC&quot;</span>,<span class="st">&quot;TCGA-LUAD&quot;</span>,<span class="st">&quot;TCGA-KIRP&quot;</span>,<span class="st">&quot;TCGA-PRAD&quot;</span>,<span class="st">&quot;TCGA-CESC&quot;</span>,<span class="st">&quot;TCGA-ESCA&quot;</span>,<span class="st">&quot;TCGA-COAD&quot;</span>,<span class="st">&quot;TCGA-BLCA&quot;</span>,<span class="st">&quot;TCGA-SARC&quot;</span>,<span class="st">&quot;TCGA-STAD&quot;</span>,<span class="st">&quot;TCGA-OV&quot;</span>,<span class="st">&quot;TCGA-MESO&quot;</span>,<span class="st">&quot;TCGA-READ&quot;</span>,<span class="st">&quot;TCGA-LUSC&quot;</span>,<span class="st">&quot;TCGA-SKCM&quot;</span>,<span class="st">&quot;TCGA-UCS&quot;</span>,<span class="st">&quot;TCGA-GBM&quot;</span>,<span class="st">&quot;TCGA-LGG&quot;</span>)</span>
<span id="cb54-3"><a href="tcga-pancanatlas.html#cb54-3" tabindex="-1"></a></span>
<span id="cb54-4"><a href="tcga-pancanatlas.html#cb54-4" tabindex="-1"></a>plot.data<span class="sc">$</span>OS_month_5y <span class="ot">&lt;-</span> plot.data<span class="sc">$</span><span class="st">`</span><span class="at">OS.month.(5.years)</span><span class="st">`</span></span>
<span id="cb54-5"><a href="tcga-pancanatlas.html#cb54-5" tabindex="-1"></a>plot.data<span class="sc">$</span>OS_status_5y <span class="ot">&lt;-</span> plot.data<span class="sc">$</span><span class="st">`</span><span class="at">OS.status.(5.years)</span><span class="st">`</span></span>
<span id="cb54-6"><a href="tcga-pancanatlas.html#cb54-6" tabindex="-1"></a>plot.data<span class="sc">$</span>p53mut <span class="ot">&lt;-</span> plot.data<span class="sc">$</span><span class="st">`</span><span class="at">p53-mut</span><span class="st">`</span></span>
<span id="cb54-7"><a href="tcga-pancanatlas.html#cb54-7" tabindex="-1"></a>total.list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb54-8"><a href="tcga-pancanatlas.html#cb54-8" tabindex="-1"></a>out.data <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb54-9"><a href="tcga-pancanatlas.html#cb54-9" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(TCGA.OS)) {</span>
<span id="cb54-10"><a href="tcga-pancanatlas.html#cb54-10" tabindex="-1"></a>  sub <span class="ot">&lt;-</span> plot.data[<span class="fu">which</span>(plot.data<span class="sc">$</span>TCGA.cohort <span class="sc">==</span> TCGA.OS[j]), ]</span>
<span id="cb54-11"><a href="tcga-pancanatlas.html#cb54-11" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(<span class="fu">unique</span>(sub<span class="sc">$</span>p53mut)) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb54-12"><a href="tcga-pancanatlas.html#cb54-12" tabindex="-1"></a>    fit <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(OS_month_5y, OS_status_5y) <span class="sc">~</span> p53mut, <span class="at">data =</span> sub)</span>
<span id="cb54-13"><a href="tcga-pancanatlas.html#cb54-13" tabindex="-1"></a>    fit.info <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit)</span>
<span id="cb54-14"><a href="tcga-pancanatlas.html#cb54-14" tabindex="-1"></a>    sub.p <span class="ot">&lt;-</span> <span class="fu">survdiff</span>(<span class="fu">Surv</span>(OS_month_5y, OS_status_5y) <span class="sc">~</span> p53mut, <span class="at">data =</span> sub)<span class="sc">$</span>pvalue</span>
<span id="cb54-15"><a href="tcga-pancanatlas.html#cb54-15" tabindex="-1"></a>    fit.info.out <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;p53&quot;</span>, TCGA.OS[j], fit.info<span class="sc">$</span>conf.int[<span class="dv">1</span>], </span>
<span id="cb54-16"><a href="tcga-pancanatlas.html#cb54-16" tabindex="-1"></a>                      fit.info<span class="sc">$</span>conf.int[<span class="dv">3</span>], fit.info<span class="sc">$</span>conf.int[<span class="dv">4</span>], sub.p )</span>
<span id="cb54-17"><a href="tcga-pancanatlas.html#cb54-17" tabindex="-1"></a>    out.data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(out.data, fit.info.out)</span>
<span id="cb54-18"><a href="tcga-pancanatlas.html#cb54-18" tabindex="-1"></a>  }</span>
<span id="cb54-19"><a href="tcga-pancanatlas.html#cb54-19" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(OS_month_5y, OS_status_5y) <span class="sc">~</span> p53mut, <span class="at">data =</span> sub)</span>
<span id="cb54-20"><a href="tcga-pancanatlas.html#cb54-20" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggsurvplot</span>(fit, <span class="at">data =</span> sub,</span>
<span id="cb54-21"><a href="tcga-pancanatlas.html#cb54-21" tabindex="-1"></a>                  <span class="at">xlab =</span> <span class="st">&#39;Time (Months)&#39;</span>,</span>
<span id="cb54-22"><a href="tcga-pancanatlas.html#cb54-22" tabindex="-1"></a>                  <span class="at">pval =</span> <span class="cn">TRUE</span>,</span>
<span id="cb54-23"><a href="tcga-pancanatlas.html#cb54-23" tabindex="-1"></a>                  <span class="at">risk.table =</span> <span class="cn">FALSE</span>, </span>
<span id="cb54-24"><a href="tcga-pancanatlas.html#cb54-24" tabindex="-1"></a>                  <span class="at">risk.table.height =</span> <span class="fl">0.28</span>, </span>
<span id="cb54-25"><a href="tcga-pancanatlas.html#cb54-25" tabindex="-1"></a>                  <span class="at">conf.int.alpha =</span> <span class="fl">0.05</span>,</span>
<span id="cb54-26"><a href="tcga-pancanatlas.html#cb54-26" tabindex="-1"></a>                  <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">surv.median.line =</span> <span class="st">&#39;hv&#39;</span>,</span>
<span id="cb54-27"><a href="tcga-pancanatlas.html#cb54-27" tabindex="-1"></a>                  <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>),</span>
<span id="cb54-28"><a href="tcga-pancanatlas.html#cb54-28" tabindex="-1"></a>                  <span class="at">axes.offset =</span> <span class="cn">TRUE</span>,</span>
<span id="cb54-29"><a href="tcga-pancanatlas.html#cb54-29" tabindex="-1"></a>                  <span class="at">break.time.by =</span> <span class="dv">12</span>,  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">60</span>),</span>
<span id="cb54-30"><a href="tcga-pancanatlas.html#cb54-30" tabindex="-1"></a>                  <span class="at">title=</span> TCGA.OS[j] ) </span>
<span id="cb54-31"><a href="tcga-pancanatlas.html#cb54-31" tabindex="-1"></a>  total.list <span class="ot">&lt;-</span> <span class="fu">c</span>(total.list, <span class="fu">list</span>(<span class="at">p =</span> p))</span>
<span id="cb54-32"><a href="tcga-pancanatlas.html#cb54-32" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Warning in .add_surv_median(p, fit, type = surv.median.line, fun = fun, : Median survival not reached.

## Warning in .add_surv_median(p, fit, type = surv.median.line, fun = fun, : Median survival not reached.

## Warning in .add_surv_median(p, fit, type = surv.median.line, fun = fun, : Median survival not reached.

## Warning in .add_surv_median(p, fit, type = surv.median.line, fun = fun, : Median survival not reached.

## Warning in .add_surv_median(p, fit, type = surv.median.line, fun = fun, : Median survival not reached.

## Warning in .add_surv_median(p, fit, type = surv.median.line, fun = fun, : Median survival not reached.

## Warning in .add_surv_median(p, fit, type = surv.median.line, fun = fun, : Median survival not reached.

## Warning in .add_surv_median(p, fit, type = surv.median.line, fun = fun, : Median survival not reached.</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="tcga-pancanatlas.html#cb56-1" tabindex="-1"></a><span class="fu">names</span>(total.list) <span class="ot">&lt;-</span> TCGA.OS</span>
<span id="cb56-2"><a href="tcga-pancanatlas.html#cb56-2" tabindex="-1"></a></span>
<span id="cb56-3"><a href="tcga-pancanatlas.html#cb56-3" tabindex="-1"></a></span>
<span id="cb56-4"><a href="tcga-pancanatlas.html#cb56-4" tabindex="-1"></a>out.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(out.data)</span>
<span id="cb56-5"><a href="tcga-pancanatlas.html#cb56-5" tabindex="-1"></a><span class="fu">colnames</span>(out.data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Gene&quot;</span>, <span class="st">&quot;Cohort&quot;</span>, <span class="st">&quot;HR&quot;</span>, <span class="st">&quot;low.95&quot;</span>, <span class="st">&quot;high.95&quot;</span>, <span class="st">&quot;P.value&quot;</span>)</span>
<span id="cb56-6"><a href="tcga-pancanatlas.html#cb56-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>) {out.data[, i] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(out.data[, i]))}</span>
<span id="cb56-7"><a href="tcga-pancanatlas.html#cb56-7" tabindex="-1"></a>out.data<span class="sc">$</span>Prognosis <span class="ot">&lt;-</span> <span class="st">&quot;Others&quot;</span></span>
<span id="cb56-8"><a href="tcga-pancanatlas.html#cb56-8" tabindex="-1"></a>out.data<span class="sc">$</span>Prognosis[<span class="fu">which</span>(out.data<span class="sc">$</span>HR <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> out.data<span class="sc">$</span>P.value <span class="sc">&lt;</span> <span class="fl">0.05</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;Unfavourable&quot;</span></span>
<span id="cb56-9"><a href="tcga-pancanatlas.html#cb56-9" tabindex="-1"></a>out.data<span class="sc">$</span>Prognosis[<span class="fu">which</span>(out.data<span class="sc">$</span>HR <span class="sc">&lt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> out.data<span class="sc">$</span>P.value <span class="sc">&lt;</span> <span class="fl">0.05</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;Favourable&quot;</span></span>
<span id="cb56-10"><a href="tcga-pancanatlas.html#cb56-10" tabindex="-1"></a><span class="fu">rownames</span>(out.data) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb56-11"><a href="tcga-pancanatlas.html#cb56-11" tabindex="-1"></a><span class="fu">print</span>(out.data)</span>
<span id="cb56-12"><a href="tcga-pancanatlas.html#cb56-12" tabindex="-1"></a></span>
<span id="cb56-13"><a href="tcga-pancanatlas.html#cb56-13" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">arrange_ggsurvplots</span>(total.list, <span class="at">ncol =</span> <span class="dv">7</span>, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">print =</span> <span class="cn">FALSE</span>)</span>
<span id="cb56-14"><a href="tcga-pancanatlas.html#cb56-14" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="p53-compounds_files/figure-html/unnamed-chunk-28-1.png" width="1344" style="display: block; margin: auto;" /></p>
</div>
<div id="mdm2-expression" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> MDM2 expression<a href="tcga-pancanatlas.html#mdm2-expression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Boxplot of MDM2 gene expression in TCGA Pan-Cancer Atlas. Fragments Per Kilobase of transcript per Million mapped reads (FPKM) is used for evaluating gene expression.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="tcga-pancanatlas.html#cb57-1" tabindex="-1"></a>tcga.meta <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">&quot;02.tcga/Table8.xlsx&quot;</span>, <span class="at">sheet =</span> <span class="dv">1</span>, <span class="at">startRow =</span> <span class="dv">2</span>)</span>
<span id="cb57-2"><a href="tcga-pancanatlas.html#cb57-2" tabindex="-1"></a></span>
<span id="cb57-3"><a href="tcga-pancanatlas.html#cb57-3" tabindex="-1"></a>plot.order <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(tcga.meta<span class="sc">$</span>MDM2.expression, <span class="fu">list</span>(<span class="at">Cohort =</span> tcga.meta<span class="sc">$</span>TCGA.cohort), median)</span>
<span id="cb57-4"><a href="tcga-pancanatlas.html#cb57-4" tabindex="-1"></a>plot.order <span class="ot">&lt;-</span> plot.order[<span class="fu">order</span>(plot.order<span class="sc">$</span>x, <span class="at">decreasing =</span> F), ]</span>
<span id="cb57-5"><a href="tcga-pancanatlas.html#cb57-5" tabindex="-1"></a><span class="fu">rownames</span>(plot.order) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb57-6"><a href="tcga-pancanatlas.html#cb57-6" tabindex="-1"></a>plot.order</span>
<span id="cb57-7"><a href="tcga-pancanatlas.html#cb57-7" tabindex="-1"></a></span>
<span id="cb57-8"><a href="tcga-pancanatlas.html#cb57-8" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(tcga.meta, </span>
<span id="cb57-9"><a href="tcga-pancanatlas.html#cb57-9" tabindex="-1"></a>               <span class="at">x =</span> <span class="st">&quot;TCGA.cohort&quot;</span>, <span class="at">y =</span> <span class="st">&quot;MDM2.expression&quot;</span>,</span>
<span id="cb57-10"><a href="tcga-pancanatlas.html#cb57-10" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;#b2ebff&quot;</span>,</span>
<span id="cb57-11"><a href="tcga-pancanatlas.html#cb57-11" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">width =</span> <span class="fl">0.7</span>,</span>
<span id="cb57-12"><a href="tcga-pancanatlas.html#cb57-12" tabindex="-1"></a>               <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;MDM2 expression&quot;</span>,</span>
<span id="cb57-13"><a href="tcga-pancanatlas.html#cb57-13" tabindex="-1"></a>               <span class="at">order =</span> plot.order<span class="sc">$</span>Cohort,</span>
<span id="cb57-14"><a href="tcga-pancanatlas.html#cb57-14" tabindex="-1"></a>               <span class="at">main =</span> <span class="st">&quot;MDM2&quot;</span>,</span>
<span id="cb57-15"><a href="tcga-pancanatlas.html#cb57-15" tabindex="-1"></a>               <span class="at">outlier.shape =</span> <span class="cn">NA</span>,</span>
<span id="cb57-16"><a href="tcga-pancanatlas.html#cb57-16" tabindex="-1"></a>               <span class="at">outlier.size =</span> <span class="dv">1</span>,</span>
<span id="cb57-17"><a href="tcga-pancanatlas.html#cb57-17" tabindex="-1"></a>               <span class="at">legend =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb57-18"><a href="tcga-pancanatlas.html#cb57-18" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">theme_base</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.background =</span> <span class="fu">element_blank</span>())</span>
<span id="cb57-19"><a href="tcga-pancanatlas.html#cb57-19" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>,<span class="at">hjust =</span> <span class="dv">1</span>,<span class="at">vjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb57-20"><a href="tcga-pancanatlas.html#cb57-20" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="p53-compounds_files/figure-html/unnamed-chunk-29-1.png" width="768" style="display: block; margin: auto;" /></p>
<div id="radar-plot" class="section level3 hasAnchor" number="6.6.1">
<h3><span class="header-section-number">6.6.1</span> Radar plot<a href="tcga-pancanatlas.html#radar-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Radar plots predicting treatment sensitivity of p53 rescue therapy in the indicated cancer types</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="tcga-pancanatlas.html#cb58-1" tabindex="-1"></a>tcga.rank <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">&quot;02.tcga/Table9.xlsx&quot;</span>, <span class="at">sheet =</span> <span class="dv">1</span>, <span class="at">startRow =</span> <span class="dv">2</span>)</span>
<span id="cb58-2"><a href="tcga-pancanatlas.html#cb58-2" tabindex="-1"></a>tcga.rank<span class="sc">$</span>CohortSim <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(tcga.rank<span class="sc">$</span>Cohort, <span class="st">&quot;TCGA-&quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb58-3"><a href="tcga-pancanatlas.html#cb58-3" tabindex="-1"></a></span>
<span id="cb58-4"><a href="tcga-pancanatlas.html#cb58-4" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Rank.(HR.of.high.expression.of.p53.targets);.data.derived.from.S1K&quot;</span>,</span>
<span id="cb58-5"><a href="tcga-pancanatlas.html#cb58-5" tabindex="-1"></a>         <span class="st">&quot;Rank.(HR.of.high.expression.of.WT-up.genes);.data.derived.from.S1K&quot;</span>,</span>
<span id="cb58-6"><a href="tcga-pancanatlas.html#cb58-6" tabindex="-1"></a>         <span class="st">&quot;Rank.(HR.of.high.expression.of.MUT-up.genes);.data.derived.from.S1K&quot;</span>,</span>
<span id="cb58-7"><a href="tcga-pancanatlas.html#cb58-7" tabindex="-1"></a>         <span class="st">&quot;Rank.(HR.of.p53-mut);.data.derived.from.S1M&quot;</span>,</span>
<span id="cb58-8"><a href="tcga-pancanatlas.html#cb58-8" tabindex="-1"></a>         <span class="st">&quot;Rank.(MDM2.expression);.data.derived.from.S1N&quot;</span>,</span>
<span id="cb58-9"><a href="tcga-pancanatlas.html#cb58-9" tabindex="-1"></a>         <span class="st">&quot;Rank.(Powerfulness.in.regulating.MUT-up.genes);.data.derived.from.S1L&quot;</span>,</span>
<span id="cb58-10"><a href="tcga-pancanatlas.html#cb58-10" tabindex="-1"></a>         <span class="st">&quot;Rank.(Powerfulness.in.regulating.WT-up.genes);.data.derived.from.S1L&quot;</span>,</span>
<span id="cb58-11"><a href="tcga-pancanatlas.html#cb58-11" tabindex="-1"></a>         <span class="st">&quot;Rank.(Powerfulness.in.regulating.p53.targets);.data.derived.from.S1L&quot;</span> )</span>
<span id="cb58-12"><a href="tcga-pancanatlas.html#cb58-12" tabindex="-1"></a>idx[<span class="sc">!</span>idx <span class="sc">%in%</span> <span class="fu">colnames</span>(tcga.rank)]</span></code></pre></div>
<pre><code>## character(0)</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="tcga-pancanatlas.html#cb60-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">5</span>))</span>
<span id="cb60-2"><a href="tcga-pancanatlas.html#cb60-2" tabindex="-1"></a><span class="cf">for</span> (kkk <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(tcga.rank)) {</span>
<span id="cb60-3"><a href="tcga-pancanatlas.html#cb60-3" tabindex="-1"></a>  plot.mat <span class="ot">&lt;-</span> tcga.rank[kkk, idx ]</span>
<span id="cb60-4"><a href="tcga-pancanatlas.html#cb60-4" tabindex="-1"></a>  plot.mat <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">rep</span>(<span class="dv">33</span>, <span class="fu">length</span>(plot.mat)), <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(plot.mat)), plot.mat)</span>
<span id="cb60-5"><a href="tcga-pancanatlas.html#cb60-5" tabindex="-1"></a>  <span class="fu">colnames</span>(plot.mat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;HR.targets&quot;</span>,<span class="st">&quot;HR.WT-up&quot;</span>,<span class="st">&quot;HR.MUT-up&quot;</span>,<span class="st">&quot;HR.p53&quot;</span>,<span class="st">&quot;MDM2&quot;</span>,<span class="st">&quot;power.MUT-up&quot;</span>,<span class="st">&quot;power.WT-up&quot;</span>,<span class="st">&quot;power.targets&quot;</span>)</span>
<span id="cb60-6"><a href="tcga-pancanatlas.html#cb60-6" tabindex="-1"></a>  <span class="fu">radarchart</span>(<span class="fu">as.data.frame</span>(plot.mat), </span>
<span id="cb60-7"><a href="tcga-pancanatlas.html#cb60-7" tabindex="-1"></a>             <span class="at">pcol =</span> <span class="fu">c</span>( <span class="st">&quot;#dd0000&quot;</span>),</span>
<span id="cb60-8"><a href="tcga-pancanatlas.html#cb60-8" tabindex="-1"></a>             <span class="at">pfcol =</span> scales<span class="sc">::</span><span class="fu">alpha</span>(<span class="fu">c</span>(<span class="st">&quot;#f28926&quot;</span>),<span class="fl">0.5</span>),</span>
<span id="cb60-9"><a href="tcga-pancanatlas.html#cb60-9" tabindex="-1"></a>             <span class="at">plwd =</span> <span class="dv">2</span>, <span class="at">plty =</span> <span class="dv">1</span>, <span class="at">axistype =</span> <span class="dv">1</span>,  </span>
<span id="cb60-10"><a href="tcga-pancanatlas.html#cb60-10" tabindex="-1"></a>             <span class="at">caxislabels =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">33</span>, <span class="dv">11</span>), <span class="at">seg =</span> <span class="dv">3</span>,</span>
<span id="cb60-11"><a href="tcga-pancanatlas.html#cb60-11" tabindex="-1"></a>             <span class="at">cglcol =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">cglty =</span> <span class="dv">1</span>, <span class="at">cglwd =</span> <span class="fl">0.8</span>, <span class="at">axislabcol =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb60-12"><a href="tcga-pancanatlas.html#cb60-12" tabindex="-1"></a>             <span class="at">vlcex =</span> <span class="fl">1.1</span>, <span class="at">pangle=</span><span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">45</span>, <span class="dv">120</span>) )</span>
<span id="cb60-13"><a href="tcga-pancanatlas.html#cb60-13" tabindex="-1"></a>  <span class="fu">title</span>(<span class="fu">paste0</span>(tcga.rank<span class="sc">$</span>CohortSim[kkk], <span class="st">&quot; (&quot;</span>, tcga.rank<span class="sc">$</span>Total.score[kkk], <span class="st">&quot;)&quot;</span>) )</span>
<span id="cb60-14"><a href="tcga-pancanatlas.html#cb60-14" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="p53-compounds_files/figure-html/unnamed-chunk-30-1.png" width="1152" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="cmap-database.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="about-this-project.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/05-TCGA-PanCancer.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["p53-compounds.pdf", "p53-compounds.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
